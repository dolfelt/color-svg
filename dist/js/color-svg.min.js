var ColorSVG={version:"0.1.0",settings:{current_color:null,size:40,multiplier:8,row_width:20,animation_speed:250,animation_type:"backout"},NS:"http://www.w3.org/2000/svg",init:function(t,i){var e=this;this.scope=t||"input.color-picker";var a=this.scope instanceof jQuery?this.scope:$(this.scope);$.extend(!0,this.settings,i),a.length>0&&a.each(function(){var t=$(this);return t.is(":input")&&t.attr("type","hidden").data("options",{color:t.val()}),e.build(t,i)})},setColor:function(t,i,e){if(!e)var a=$(this.identifier(t)),e=$("svg",a);i&&6==i.length&&(i="#"+i);var n=Snap($(".selected-color",e)[0]);n.attr({opacity:i?1:0,fill:i||"#000000"}),t.is(":input")&&t.val(i)},rgbToHex:function(t){if("#"===t.charAt(0))return t;var i=/(.*?)rgb\((\d+),\s*(\d+),\s*(\d+)\)/i.exec(t),e=parseInt(i[2],10).toString(16),a=parseInt(i[3],10).toString(16),n=parseInt(i[4],10).toString(16);return(1==e.length?"0"+e:e)+(1==a.length?"0"+a:a)+(1==n.length?"0"+n:n)},getColorCurrentHex:function(){return"undefined"!=typeof current_color?this.rgbToHex(current_color):!1},setColorCurrent:function(t){current_color=t},build:function(t,i){var e=$.extend({},this.settings,i,t.data("options"));if(t.data("settings",e),!t.data("color-id")){var a="color"+Math.round(1e4*Math.random()),n=$('<div id="'+a+'" class="color-svg-picker"/>');t.data("color-id",a),$(t).after(n),n.width(e.size).height(e.size)}var r=this;setTimeout(function(){r.updateDOM(r.picker(t)),r.events(t,e)},1)},events:function(t,i){var e=this;$("svg",this.identifier(t)).hover(function(a){var n=i.size+2*e.padding(i);$(this).width(n).height(n)[0].setAttribute("viewBox",["0 0",n,n].join(" ")),$(this).css({margin:-e.padding(i)}),e.animateHover(t,i)},function(a){e.close(t,i,this)})},close:function(t,i,e){var a=i.size,n=e||$("svg",this.identifier(t)),r=this.padding(i);this.animateHover(t,i,function(){$(n).width(a).height(a)[0].setAttribute("viewBox",[r,r,a,a].join(" ")),$(n).css({margin:0})})},updateDOM:function(t){var i=t[0],e=t[1];return $(this.identifier(i)).html(e)},animateHover:function(t,i,e){for(var a=$(this.identifier(t)),n=$("svg",a),r=i.size+2*this.padding(i),s=r/2,o=r/2,c=$("g[data-id]",n),d=0;d<c.length;d++){var h=c[d],f=parseInt(h.getAttribute("data-id").replace("g",""),10),l=e?1:f+2,u=0==d,v=i.animation_type,p=i.animation_speed*(d+1);if(!f){if(!e){var g=i.size/2;l=(g-5)/g}v="easein",p=1.5*i.animation_speed}Snap(h).stop().animate({transform:"s"+l+" "+l+" "+s+" "+o},p,mina[v],u?e||null:null)}var b=$(".selected-color",n)[0],m=Snap(b);m.stop().animate({transform:"s"+l+" "+l+" "+s+" "+o},p,mina[v])},picker:function(t){var i=t.data("settings"),e=this.svg(t,i),a=$(this.identifier(t)),n=a.outerWidth(),r=this.padding(i),s=this.defaultColors.slice();s.reverse();for(var o=0;o<s.length;o++)for(var c=0,d=1/s[o].length*Math.PI*2,h=s[o],f=s.length-(o+1),l=0;l<h.length;l++){var u=c+d,v=n/2+r,p=n/2+r,g=n/2,b=g-5,m=[f,l].join(""),_=$('path[data-id="s'+m+'"]',e);if(_.length>0)var M=_[0];else var M=this.svg_obj("path");this.annular_sector(M,{centerX:v,centerY:p,startDegrees:c,endDegrees:u,innerRadius:0==f?0:(b+(f-1)*i.row_width)/(f+2),outerRadius:0==f?g:(b+f*i.row_width)/(f+2)}),this.set_attr(M,{fill:"#"+h[l],"data-cx":v,"data-cy":p,"data-id":"s"+m});var w=$("g[data-id=g"+f+"]",e);if(w.length<1){var C=this.svg_obj("g");C.setAttribute("data-id","g"+f),C.appendChild(M),e.appendChild(C)}else w[0].appendChild(M);if(f){var R=Snap(M);this.animate(R,v,p,i,f),this.action(R,t,i)}c=u}var j=Snap(e),y=j.circle(v,p,n/2+.1),S=Snap(e).circle(v,p,n/2-5);y.attr({"class":"selected-color"}),this.setColor(t,i.color,e),S.attr({"class":"icon"});var x=this.svg_obj("g"),k=this.svg_obj("path");return this.set_attr(x,{transform:"translate("+[v-7,p-7].join(" ")+")"}),this.set_attr(k,{d:"M3.4,12.8L4.2,12L2,9.8l-0.8,0.8v1h1.2v1.2H3.4z M8.2,4.2C8.2,4.1,8.1,4,8,4c-0.1,0-0.1,0-0.2,0.1l-5,5c0,0-0.1,0.1-0.1,0.2c0,0.1,0.1,0.2,0.2,0.2c0.1,0,0.1,0,0.2-0.1l5-5C8.2,4.4,8.2,4.3,8.2,4.2z M7.7,2.5l3.8,3.8L3.8,14H0v-3.8 L7.7,2.5z M14,3.4c0,0.3-0.1,0.6-0.3,0.8l-1.5,1.5L8.3,1.9l1.5-1.5C10,0.1,10.3,0,10.6,0c0.3,0,0.6,0.1,0.8,0.4l2.2,2.2 C13.9,2.8,14,3,14,3.4z","class":"pencil"}),x.appendChild(k),e.appendChild(x),[t,e]},eventHandler:function(){"undefined"!=typeof this.settings.eventHandler&&this.settings.eventHandler()},action:function(t,i,e){var a=this;t.click(function(t){var n=Snap(t.target),r=n.attr("fill");n.attr({strokeWidth:0}),a.setColor(i,r),a.close(i,e),a.eventHandler()})},animate:function(t,i,e,a,n){var r=1,s=r+.05;t.hover(function(t){var r=Snap(t.target);r.appendTo(r.parent()),r.attr({strokeWidth:1/(n+2)}),r.stop().animate({transform:"s"+s+" "+s+" "+i+" "+e},a.animation_speed,mina[a.animation_type])},function(t){var n=Snap(t.target);n.attr({strokeWidth:0}),n.stop().animate({transform:"s"+r+" "+r+" "+i+" "+e},a.animation_speed,mina[a.animation_type])})},annular_sector:function(t,i){function e(t){var i={cx:t.centerX||0,cy:t.centerY||0,startRadians:t.startDegrees||0,closeRadians:t.endDegrees||0},e=void 0!==t.thickness?t.thickness:100;return i.r1=void 0!==t.innerRadius?t.innerRadius:void 0!==t.outerRadius?t.outerRadius-e:200-e,i.r2=void 0!==t.outerRadius?t.outerRadius:i.r1+e,i.r1<0&&(i.r1=0),i.r2<0&&(i.r2=0),i}var a=e(i),n=[[a.cx+a.r2*Math.sin(a.startRadians),a.cy-a.r2*Math.cos(a.startRadians)],[a.cx+a.r2*Math.sin(a.closeRadians),a.cy-a.r2*Math.cos(a.closeRadians)],[a.cx+a.r1*Math.sin(a.closeRadians),a.cy-a.r1*Math.cos(a.closeRadians)],[a.cx+a.r1*Math.sin(a.startRadians),a.cy-a.r1*Math.cos(a.startRadians)]],r=a.closeRadians-a.startRadians,s=r%(2*Math.PI)>Math.PI?1:0,o=[];o.push("M"+n[0].join()),o.push("A"+[a.r2,a.r2,0,s,1,n[1]].join()),o.push("L"+n[2].join()),o.push("A"+[a.r1,a.r1,0,s,0,n[3]].join()),o.push("z"),this.set_attr(t,{stroke:"white","stroke-width":0,d:o.join(" ")})},padding:function(t){return(this.defaultColors.length-1)*t.row_width},svg:function(t,i){var e=$(this.identifier(t)),a=$("svg",e),n=e.width(),r=e.height();if(a.length>0)a=a[0];else{var a=this.svg_obj("svg");a.width=n,a.height=r}var s=this.padding(i),o=s+" "+s+" "+n+" "+r;return this.set_attr(a,{width:"100%",height:"100%",viewBox:o}),a},identifier:function(t){return"#"+t.data("color-id")},throttle:function(t,i){var e=null;return function(){var a=this,n=arguments;clearTimeout(e),e=setTimeout(function(){t.apply(a,n)},i)}},svg_obj:function(t){return document.createElementNS(this.NS,t)},ticks:function(t,e,a){var n=e-t,r=Math.pow(10,Math.floor(Math.log(n/a)/Math.LN10)),s=a/n*r;.15>=s?r*=10:.35>=s?r*=5:.75>=s&&(r*=2);var o=Math.ceil(t/r)*r,c=Math.floor(e/r)*r+.5*r,d=[];for(i=o;i<c;i+=r)d.push(i);return d},set_attr:function(t,i){for(attr in i)t.setAttribute(attr,i[attr]);return this},flip:function(t,i){t.setAttribute("transform","translate(0, "+i+") scale(1, -1)")},defaultColors:[["ff5c4d","ffb84d","ffff4d","baff4d","61b8b2","615cff","9e79df","ba5cb2"],["c81717","f45f21","ffd800","00952a","00b19a","174aa7","6954c4","b03faa"],["982424","f13434","ff9264","ba4717","cdae00","ffeb7d","00cc39","006e1f","008574","1df3d7","3576ec","234075","4a3b8c","9981ff","ec59e4","812c7c"],["7a0e2d","9c2b41","d25b73","fe6080","fe943e","cd6612","95490c","6c3101","a17900","d19d00","ffc000","d3c162","bcff76","88ec1f","279a52","326100","104e46","4b877f","6fbbb1","a6eae1","35aeec","2491b0","0d647d","004255","330e71","5400a3","8300ff","b76aff","e12bec","a10faa","730a7a","4b0050"]]};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbG9yLXN2Zy5taW4uanMiXSwibmFtZXMiOlsiQ29sb3JTVkciLCJ2ZXJzaW9uIiwic2V0dGluZ3MiLCJjdXJyZW50X2NvbG9yIiwic2l6ZSIsIm11bHRpcGxpZXIiLCJyb3dfd2lkdGgiLCJhbmltYXRpb25fc3BlZWQiLCJhbmltYXRpb25fdHlwZSIsIk5TIiwiaW5pdCIsInNjb3BlIiwib3B0aW9ucyIsInNlbGYiLCJ0aGlzIiwicGlja2VycyIsImpRdWVyeSIsIiQiLCJleHRlbmQiLCJsZW5ndGgiLCJlYWNoIiwiaW5wdXQiLCJpcyIsImF0dHIiLCJkYXRhIiwiY29sb3IiLCJ2YWwiLCJidWlsZCIsInNldENvbG9yIiwic3ZnIiwiY29udGFpbmVyIiwiaWRlbnRpZmllciIsImNpcmNsZSIsIlNuYXAiLCJvcGFjaXR5IiwiZmlsbCIsInJnYlRvSGV4IiwiY2hhckF0IiwibnVtcyIsImV4ZWMiLCJyIiwicGFyc2VJbnQiLCJ0b1N0cmluZyIsImciLCJiIiwiZ2V0Q29sb3JDdXJyZW50SGV4Iiwic2V0Q29sb3JDdXJyZW50IiwiX3NldHRpbmdzIiwiaWQiLCJNYXRoIiwicm91bmQiLCJyYW5kb20iLCJkaXYiLCJhZnRlciIsIndpZHRoIiwiaGVpZ2h0Iiwic2V0VGltZW91dCIsInVwZGF0ZURPTSIsInBpY2tlciIsImV2ZW50cyIsImhvdmVyIiwiZSIsImRpbWVuIiwicGFkZGluZyIsInNldEF0dHJpYnV0ZSIsImpvaW4iLCJjc3MiLCJtYXJnaW4iLCJhbmltYXRlSG92ZXIiLCJjbG9zZSIsImVsZW0iLCJwYXJ0cyIsImdyYXBoIiwiaHRtbCIsImNsb3NlX2NhbGxiYWNrIiwiYmFzZSIsImN4IiwiY3kiLCJncm91cHMiLCJncm91cCIsImdldEF0dHJpYnV0ZSIsInJlcGxhY2UiLCJzY2FsZSIsImRvX2NhbGxiYWNrIiwiYW5pbWF0aW9uIiwic3BlZWQiLCJoYWxmIiwic3RvcCIsImFuaW1hdGUiLCJ0cmFuc2Zvcm0iLCJtaW5hIiwiY2lyIiwib3V0ZXJXaWR0aCIsIl9jb2xvcnMiLCJkZWZhdWx0Q29sb3JzIiwic2xpY2UiLCJyZXZlcnNlIiwiYyIsInN0YXJ0X2FuZ2xlIiwiYW5nbGUiLCJQSSIsImxldmVsIiwiaSIsImVuZF9hbmdsZSIsImlubmVyUiIsInBpZCIsImV4aXN0aW5nX3BhdGgiLCJwYXRoIiwic3ZnX29iaiIsImFubnVsYXJfc2VjdG9yIiwiY2VudGVyWCIsImNlbnRlclkiLCJzdGFydERlZ3JlZXMiLCJlbmREZWdyZWVzIiwiaW5uZXJSYWRpdXMiLCJvdXRlclJhZGl1cyIsInNldF9hdHRyIiwiZGF0YS1jeCIsImRhdGEtY3kiLCJkYXRhLWlkIiwiZXhpc3RpbmdfZ3JvdXAiLCJhcHBlbmRDaGlsZCIsImVsIiwiYWN0aW9uIiwic25wIiwiY29sb3JlZENpcmNsZSIsImNpcmNsZU92ZXJsYXkiLCJjbGFzcyIsInBlbmNpbCIsInBpbm5lciIsImQiLCJldmVudEhhbmRsZXIiLCJjbGljayIsInRhcmdldCIsInN0cm9rZVdpZHRoIiwiYmFzZV9zY2FsZSIsImFwcGVuZFRvIiwicGFyZW50Iiwib3B0aW9uc1dpdGhEZWZhdWx0cyIsIm8iLCJvMiIsInN0YXJ0UmFkaWFucyIsImNsb3NlUmFkaWFucyIsInQiLCJ1bmRlZmluZWQiLCJ0aGlja25lc3MiLCJyMSIsInIyIiwib3B0cyIsInAiLCJzaW4iLCJjb3MiLCJhbmdsZURpZmYiLCJsYXJnZUFyYyIsImNtZHMiLCJwdXNoIiwic3Ryb2tlIiwic3Ryb2tlLXdpZHRoIiwidmlld19ib3giLCJ2aWV3Qm94IiwidGhyb3R0bGUiLCJmdW4iLCJkZWxheSIsInRpbWVyIiwiY29udGV4dCIsImFyZ3MiLCJhcmd1bWVudHMiLCJjbGVhclRpbWVvdXQiLCJhcHBseSIsInR5cGUiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnROUyIsInRpY2tzIiwibWluIiwibWF4IiwiY291bnQiLCJzcGFuIiwic3RlcCIsInBvdyIsImZsb29yIiwibG9nIiwiTE4xMCIsImVyciIsInRzdGFydCIsImNlaWwiLCJ0c3Rv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UEEsRUFDeENMLElBSUosS0FBS3RFLEVBQUVpRixFQUFRakYsRUFBSW1GLEVBQU9uRixHQUFLMkUsRUFDM0JMLEVBQU1qQixLQUFLckQsRUFFZixPQUFPc0UsSUFHWHhELFNBQVcsU0FBVXNFLEVBQU1DLEdBRXZCLElBQUtwSyxPQUFRb0ssR0FDVEQsRUFBSzFILGFBQWF6QyxLQUFNb0ssRUFBTXBLLE1BR2xDLE9BQU9ULE9BR1g4SyxLQUFPLFNBQVVGLEVBQU1HLEdBQ25CSCxFQUFLMUgsYUFBYSxZQUFhLGdCQUFrQjZILEVBQUcsbUJBR3hEL0YsZ0JBR1EsU0FDQSxTQUNBLFNBQ0EsU0FDQSxTQUNBLFNBQ0EsU0FDQSxXQUlBLFNBQ0EsU0FDQSxTQUNBLFNBQ0EsU0FDQSxTQUNBLFNBQ0EsV0FJQSxTQUNBLFNBQ0EsU0FDQSxTQUNBLFNBQ0EsU0FDQSxTQUNBLFNBQ0EsU0FDQSxTQUNBLFNBQ0EsU0FDQSxTQUNBLFNBQ0EsU0FDQSxXQU1BLFNBQ0EsU0FDQSxTQUNBLFNBRUEsU0FDQSxTQUNBLFNBQ0EsU0FFQSxTQUNBLFNBQ0EsU0FDQSxTQUVBLFNBQ0EsU0FDQSxTQUNBLFNBRUEsU0FDQSxTQUNBLFNBQ0EsU0FFQSxTQUNBLFNBQ0EsU0FDQSxTQUVBLFNBQ0EsU0FDQSxTQUNBLFNBRUEsU0FDQSxTQUNBLFNBQ0EiLCJmaWxlIjoiY29sb3Itc3ZnLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBDb2xvclNWRyA9IHtcbiAgICB2ZXJzaW9uIDogJzAuMS4wJyxcblxuICAgIHNldHRpbmdzIDoge1xuICAgICAgICBjdXJyZW50X2NvbG9yOiBudWxsLFxuICAgICAgICBzaXplOiA0MCxcbiAgICAgICAgbXVsdGlwbGllcjogOCxcbiAgICAgICAgcm93X3dpZHRoOiAyMCxcbiAgICAgICAgYW5pbWF0aW9uX3NwZWVkOiAyNTAsXG4gICAgICAgIGFuaW1hdGlvbl90eXBlOiAnYmFja291dCcgLy8gb3B0aW9uczogYmFja2luLCBiYWNrb3V0LCBib3VuY2UsIGVhc2VpbiwgZWFzZWlub3V0LCBlYXNlb3V0LCBsaW5lYXJcbiAgICB9LFxuXG4gICAgTlMgOiAnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLFxuXG4gICAgaW5pdCA6IGZ1bmN0aW9uIChzY29wZSwgb3B0aW9ucykge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuc2NvcGUgPSBzY29wZSB8fCAnaW5wdXQuY29sb3ItcGlja2VyJztcblxuICAgICAgICB2YXIgcGlja2VycyA9IHRoaXMuc2NvcGUgaW5zdGFuY2VvZiBqUXVlcnkgPyB0aGlzLnNjb3BlIDogJCh0aGlzLnNjb3BlKTtcblxuICAgICAgICAkLmV4dGVuZCh0cnVlLCB0aGlzLnNldHRpbmdzLCBvcHRpb25zKTtcblxuICAgICAgICBpZiAocGlja2Vycy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBwaWNrZXJzLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBpbnB1dCA9ICQodGhpcyk7XG4gICAgICAgICAgICAgICAgaWYgKGlucHV0LmlzKCc6aW5wdXQnKSkge1xuICAgICAgICAgICAgICAgICAgICBpbnB1dC5hdHRyKCd0eXBlJywnaGlkZGVuJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kYXRhKCdvcHRpb25zJywge2NvbG9yOiBpbnB1dC52YWwoKX0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLmJ1aWxkKGlucHV0LCBvcHRpb25zKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy90aGlzLmV2ZW50cygpO1xuICAgIH0sXG5cbiAgICBzZXRDb2xvciA6IGZ1bmN0aW9uKGlucHV0LCBjb2xvciwgc3ZnKSB7XG4gICAgICAgIGlmICghc3ZnKSB7XG4gICAgICAgICAgICB2YXIgY29udGFpbmVyID0gJCh0aGlzLmlkZW50aWZpZXIoaW5wdXQpKSxcbiAgICAgICAgICAgICAgICBzdmcgPSAkKCdzdmcnLCBjb250YWluZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNvbG9yICYmIGNvbG9yLmxlbmd0aCA9PSA2KSBjb2xvciA9ICcjJyArIGNvbG9yO1xuXG4gICAgICAgIHZhciBjaXJjbGUgPSBTbmFwKCQoJy5zZWxlY3RlZC1jb2xvcicsIHN2ZylbMF0pO1xuICAgICAgICBjaXJjbGUuYXR0cih7XG4gICAgICAgICAgICBvcGFjaXR5OiBjb2xvciA/IDEgOiAwLFxuICAgICAgICAgICAgZmlsbDogY29sb3IgfHwgXCIjMDAwMDAwXCJcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKGlucHV0LmlzKCc6aW5wdXQnKSkge1xuICAgICAgICAgICAgaW5wdXQudmFsKGNvbG9yKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICByZ2JUb0hleCA6IGZ1bmN0aW9uIHJnYlRvSGV4KGNvbG9yKSB7XG5cbiAgICAgICAgaWYgKGNvbG9yLmNoYXJBdCgwKSA9PT0gXCIjXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBjb2xvcjtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBudW1zID0gLyguKj8pcmdiXFwoKFxcZCspLFxccyooXFxkKyksXFxzKihcXGQrKVxcKS9pLmV4ZWMoY29sb3IpLFxuICAgICAgICAgICAgciA9IHBhcnNlSW50KG51bXNbMl0sIDEwKS50b1N0cmluZygxNiksXG4gICAgICAgICAgICBnID0gcGFyc2VJbnQobnVtc1szXSwgMTApLnRvU3RyaW5nKDE2KSxcbiAgICAgICAgICAgIGIgPSBwYXJzZUludChudW1zWzRdLCAxMCkudG9TdHJpbmcoMTYpO1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAoci5sZW5ndGggPT0gMSA/IFwiMFwiKyByIDogcikgK1xuICAgICAgICAgICAgKGcubGVuZ3RoID09IDEgPyBcIjBcIisgZyA6IGcpICtcbiAgICAgICAgICAgIChiLmxlbmd0aCA9PSAxID8gXCIwXCIrIGIgOiBiKVxuICAgICAgICApO1xuXG4gICAgfSxcblxuICAgIGdldENvbG9yQ3VycmVudEhleCA6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIGlmICh0eXBlb2YgY3VycmVudF9jb2xvciAhPT0gJ3VuZGVmaW5lZCcpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZ2JUb0hleChjdXJyZW50X2NvbG9yKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgfSxcblxuICAgIHNldENvbG9yQ3VycmVudCA6IGZ1bmN0aW9uKGNvbG9yKSB7XG5cbiAgICAgICAgY3VycmVudF9jb2xvciA9IGNvbG9yO1xuXG4gICAgfSxcblxuICAgIGJ1aWxkIDogZnVuY3Rpb24oaW5wdXQsIG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIF9zZXR0aW5ncyA9ICQuZXh0ZW5kKHt9LCB0aGlzLnNldHRpbmdzLCBvcHRpb25zLCBpbnB1dC5kYXRhKCdvcHRpb25zJykpO1xuICAgICAgICBpbnB1dC5kYXRhKCdzZXR0aW5ncycsIF9zZXR0aW5ncyk7XG5cbiAgICAgICAgaWYgKCFpbnB1dC5kYXRhKCdjb2xvci1pZCcpKSB7XG4gICAgICAgICAgICB2YXIgaWQgPSBcImNvbG9yXCIgKyBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkqMTAwMDApLFxuICAgICAgICAgICAgICAgIGRpdiA9ICQoJzxkaXYgaWQ9XCInK2lkKydcIiBjbGFzcz1cImNvbG9yLXN2Zy1waWNrZXJcIi8+Jyk7XG4gICAgICAgICAgICBpbnB1dC5kYXRhKCdjb2xvci1pZCcsIGlkKTtcbiAgICAgICAgICAgICQoaW5wdXQpLmFmdGVyKGRpdik7XG4gICAgICAgICAgICBkaXYud2lkdGgoX3NldHRpbmdzLnNpemUpLmhlaWdodChfc2V0dGluZ3Muc2l6ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc2VsZi51cGRhdGVET00oc2VsZi5waWNrZXIoaW5wdXQpKTtcbiAgICAgICAgICAgIHNlbGYuZXZlbnRzKGlucHV0LCBfc2V0dGluZ3MpO1xuICAgICAgICB9LCAxKTtcbiAgICB9LFxuXG4gICAgZXZlbnRzIDogZnVuY3Rpb24gKGlucHV0LCBzZXR0aW5ncykge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgJCgnc3ZnJywgdGhpcy5pZGVudGlmaWVyKGlucHV0KSkuaG92ZXIoZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgdmFyIGRpbWVuID0gc2V0dGluZ3Muc2l6ZSArIHNlbGYucGFkZGluZyhzZXR0aW5ncykqMjtcbiAgICAgICAgICAgICQodGhpcykud2lkdGgoZGltZW4pLmhlaWdodChkaW1lbilbMF0uc2V0QXR0cmlidXRlKCd2aWV3Qm94JywgWycwIDAnLGRpbWVuLGRpbWVuXS5qb2luKCcgJykpO1xuICAgICAgICAgICAgJCh0aGlzKS5jc3Moe21hcmdpbjogLXNlbGYucGFkZGluZyhzZXR0aW5ncyl9KTtcblxuICAgICAgICAgICAgc2VsZi5hbmltYXRlSG92ZXIoaW5wdXQsIHNldHRpbmdzKTtcbiAgICAgICAgfSwgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgc2VsZi5jbG9zZShpbnB1dCwgc2V0dGluZ3MsIHRoaXMpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgY2xvc2U6IGZ1bmN0aW9uIChpbnB1dCwgc2V0dGluZ3MsIHN2Zykge1xuICAgICAgICB2YXIgZGltZW4gPSBzZXR0aW5ncy5zaXplLFxuICAgICAgICAgICAgZWxlbSA9IHN2ZyB8fCAkKCdzdmcnLCB0aGlzLmlkZW50aWZpZXIoaW5wdXQpKSxcbiAgICAgICAgICAgIHBhZGRpbmcgPSB0aGlzLnBhZGRpbmcoc2V0dGluZ3MpO1xuXG4gICAgICAgIHRoaXMuYW5pbWF0ZUhvdmVyKGlucHV0LCBzZXR0aW5ncywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkKGVsZW0pLndpZHRoKGRpbWVuKS5oZWlnaHQoZGltZW4pWzBdLnNldEF0dHJpYnV0ZSgndmlld0JveCcsIFtwYWRkaW5nLHBhZGRpbmcsZGltZW4sZGltZW5dLmpvaW4oJyAnKSk7XG4gICAgICAgICAgICAkKGVsZW0pLmNzcyh7bWFyZ2luOiAwfSk7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICB1cGRhdGVET00gOiBmdW5jdGlvbiAocGFydHMpIHtcbiAgICAgICAgdmFyIGlucHV0ID0gcGFydHNbMF0sXG4gICAgICAgICAgICBncmFwaCA9IHBhcnRzWzFdO1xuXG4gICAgICAgIHJldHVybiAkKHRoaXMuaWRlbnRpZmllcihpbnB1dCkpLmh0bWwoZ3JhcGgpO1xuICAgIH0sXG5cbiAgICBhbmltYXRlSG92ZXIgOiBmdW5jdGlvbihpbnB1dCwgc2V0dGluZ3MsIGNsb3NlX2NhbGxiYWNrKSB7XG4gICAgICAgIHZhciBjb250YWluZXIgPSAkKHRoaXMuaWRlbnRpZmllcihpbnB1dCkpLFxuICAgICAgICAgICAgc3ZnID0gJCgnc3ZnJywgY29udGFpbmVyKSxcbiAgICAgICAgICAgIGJhc2UgPSBzZXR0aW5ncy5zaXplICsgKHRoaXMucGFkZGluZyhzZXR0aW5ncykqMiksXG4gICAgICAgICAgICBjeCA9IGJhc2UvMixcbiAgICAgICAgICAgIGN5ID0gYmFzZS8gMjtcblxuICAgICAgICB2YXIgZ3JvdXBzID0gJCgnZ1tkYXRhLWlkXScsIHN2Zyk7XG5cbiAgICAgICAgZm9yICh2YXIgZyA9IDA7IGcgPCBncm91cHMubGVuZ3RoOyBnKyspIHtcbiAgICAgICAgICAgIHZhciBncm91cCA9IGdyb3Vwc1tnXSxcbiAgICAgICAgICAgICAgICBpZCA9IHBhcnNlSW50KGdyb3VwLmdldEF0dHJpYnV0ZSgnZGF0YS1pZCcpLnJlcGxhY2UoXCJnXCIsXCJcIiksIDEwKSxcbiAgICAgICAgICAgICAgICBzY2FsZSA9IGNsb3NlX2NhbGxiYWNrID8gMSA6IGlkICsgMixcbiAgICAgICAgICAgICAgICBkb19jYWxsYmFjayA9IGcgPT0gMCxcbiAgICAgICAgICAgICAgICBhbmltYXRpb24gPSBzZXR0aW5ncy5hbmltYXRpb25fdHlwZSxcbiAgICAgICAgICAgICAgICBzcGVlZCA9IHNldHRpbmdzLmFuaW1hdGlvbl9zcGVlZCAqIChnKzEpO1xuXG4gICAgICAgICAgICBpZiAoIWlkKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFjbG9zZV9jYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaGFsZiA9IHNldHRpbmdzLnNpemUvMjtcbiAgICAgICAgICAgICAgICAgICAgc2NhbGUgPSAoaGFsZi01KSAvIGhhbGY7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGFuaW1hdGlvbiA9ICdlYXNlaW4nO1xuICAgICAgICAgICAgICAgIHNwZWVkID0gc2V0dGluZ3MuYW5pbWF0aW9uX3NwZWVkICogMS41O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBTbmFwKGdyb3VwKS5zdG9wKCkuYW5pbWF0ZSh7XG4gICAgICAgICAgICAgICAgdHJhbnNmb3JtOiAncycgKyBzY2FsZSArICcgJyArIHNjYWxlICsgJyAnICsgY3ggKyAnICcgKyBjeVxuICAgICAgICAgICAgfSwgc3BlZWQsIG1pbmFbYW5pbWF0aW9uXSwgZG9fY2FsbGJhY2sgPyBjbG9zZV9jYWxsYmFjayB8fCBudWxsIDogbnVsbCk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgY2lyY2xlID0gJCgnLnNlbGVjdGVkLWNvbG9yJywgc3ZnKVswXSxcbiAgICAgICAgICAgIGNpciA9IFNuYXAoY2lyY2xlKTtcbiAgICAgICAgY2lyLnN0b3AoKS5hbmltYXRlKHtcbiAgICAgICAgICAgIHRyYW5zZm9ybTogJ3MnICsgc2NhbGUgKyAnICcgKyBzY2FsZSArICcgJyArIGN4ICsgJyAnICsgY3lcbiAgICAgICAgfSwgc3BlZWQsIG1pbmFbYW5pbWF0aW9uXSk7XG4gICAgfSxcblxuICAgIHBpY2tlcjogZnVuY3Rpb24oaW5wdXQpIHtcbiAgICAgICAgdmFyIHNldHRpbmdzID0gaW5wdXQuZGF0YSgnc2V0dGluZ3MnKSxcbiAgICAgICAgICAgIHN2ZyA9IHRoaXMuc3ZnKGlucHV0LCBzZXR0aW5ncyksXG4gICAgICAgICAgICBjb250YWluZXIgPSAkKHRoaXMuaWRlbnRpZmllcihpbnB1dCkpLFxuICAgICAgICAgICAgYmFzZSA9IGNvbnRhaW5lci5vdXRlcldpZHRoKCksXG4gICAgICAgICAgICBwYWRkaW5nID0gdGhpcy5wYWRkaW5nKHNldHRpbmdzKTtcblxuICAgICAgICB2YXIgX2NvbG9ycyA9IHRoaXMuZGVmYXVsdENvbG9ycy5zbGljZSgpO1xuICAgICAgICBfY29sb3JzLnJldmVyc2UoKTtcbiAgICAgICAgLy8gQWRkIHRoZSBsYXN0IGdyb3VwIHR3aWNlIHRoZSBlZmZlY3RcbiAgICAgICAgLy8gVE9ETzogQWxsb3cgbXVsdGlwbGUgY29sb3JzIGZvciBkaXNwbGF5OiBfY29sb3JzLnB1c2goX2NvbG9yc1tfY29sb3JzLmxlbmd0aC0xXSk7XG5cbiAgICAgICAgZm9yICh2YXIgYz0wOyBjIDwgX2NvbG9ycy5sZW5ndGg7IGMrKykge1xuXG4gICAgICAgICAgICB2YXIgc3RhcnRfYW5nbGUgPSAwLFxuICAgICAgICAgICAgICAgIGFuZ2xlID0gKDEgLyBfY29sb3JzW2NdLmxlbmd0aCkgKiBNYXRoLlBJICogMixcbiAgICAgICAgICAgICAgICBkYXRhID0gX2NvbG9yc1tjXSxcbiAgICAgICAgICAgICAgICBsZXZlbCA9IF9jb2xvcnMubGVuZ3RoIC0gKGMrMSk7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBlbmRfYW5nbGUgPSBzdGFydF9hbmdsZSArIGFuZ2xlO1xuICAgICAgICAgICAgICAgIHZhciBjeCA9IChiYXNlIC8gMikgKyBwYWRkaW5nLFxuICAgICAgICAgICAgICAgICAgICBjeSA9IChiYXNlIC8gMikgKyBwYWRkaW5nLFxuICAgICAgICAgICAgICAgICAgICByID0gIChiYXNlIC8gMiksXG4gICAgICAgICAgICAgICAgICAgIGlubmVyUiA9IHIgLSA1LFxuICAgICAgICAgICAgICAgICAgICBwaWQgPSBbbGV2ZWwsaV0uam9pbignJyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgZXhpc3RpbmdfcGF0aCA9ICQoJ3BhdGhbZGF0YS1pZD1cInMnICsgcGlkICsgJ1wiXScsIHN2Zyk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZXhpc3RpbmdfcGF0aC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXRoID0gZXhpc3RpbmdfcGF0aFswXTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aCA9IHRoaXMuc3ZnX29iaigncGF0aCcpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuYW5udWxhcl9zZWN0b3IocGF0aCwge1xuICAgICAgICAgICAgICAgICAgICBjZW50ZXJYOmN4LCBjZW50ZXJZOmN5LFxuICAgICAgICAgICAgICAgICAgICBzdGFydERlZ3JlZXM6c3RhcnRfYW5nbGUsIGVuZERlZ3JlZXM6ZW5kX2FuZ2xlLFxuICAgICAgICAgICAgICAgICAgICBpbm5lclJhZGl1czogbGV2ZWw9PTAgPyAwIDogKChpbm5lclIgKyAoKGxldmVsLTEpICogc2V0dGluZ3Mucm93X3dpZHRoKSkgLyAobGV2ZWwrMikpLFxuICAgICAgICAgICAgICAgICAgICBvdXRlclJhZGl1czogbGV2ZWw9PTAgPyByIDogKChpbm5lclIgKyAoKGxldmVsKSAqIHNldHRpbmdzLnJvd193aWR0aCkpIC8gKGxldmVsKzIpKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0X2F0dHIocGF0aCwge1xuICAgICAgICAgICAgICAgICAgICBmaWxsOiAnIycrZGF0YVtpXSxcbiAgICAgICAgICAgICAgICAgICAgLy9zdHJva2U6IHNldHRpbmdzLnN0cm9rZV9jb2xvcixcbiAgICAgICAgICAgICAgICAgICAgLy8nc3Ryb2tlV2lkdGgnOiBzZXR0aW5ncy5zdHJva2Vfd2lkdGgsXG4gICAgICAgICAgICAgICAgICAgICdkYXRhLWN4JyA6IGN4LFxuICAgICAgICAgICAgICAgICAgICAnZGF0YS1jeScgOiBjeSxcbiAgICAgICAgICAgICAgICAgICAgJ2RhdGEtaWQnIDogJ3MnICsgcGlkXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgZXhpc3RpbmdfZ3JvdXAgPSAkKCdnW2RhdGEtaWQ9ZycgKyBsZXZlbCArICddJywgc3ZnKTtcblxuICAgICAgICAgICAgICAgIGlmIChleGlzdGluZ19ncm91cC5sZW5ndGggPCAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBnID0gdGhpcy5zdmdfb2JqKCdnJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgZy5zZXRBdHRyaWJ1dGUoJ2RhdGEtaWQnLCAnZycgKyBsZXZlbCk7XG4gICAgICAgICAgICAgICAgICAgIGcuYXBwZW5kQ2hpbGQocGF0aCk7XG4gICAgICAgICAgICAgICAgICAgIHN2Zy5hcHBlbmRDaGlsZChnKTtcblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdfZ3JvdXBbMF0uYXBwZW5kQ2hpbGQocGF0aCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGxldmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbCA9IFNuYXAocGF0aCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYW5pbWF0ZShlbCwgY3gsIGN5LCBzZXR0aW5ncywgbGV2ZWwpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGlvbihlbCwgaW5wdXQsIHNldHRpbmdzKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBUaGUgbmV4dCB3ZWRnZSBiZWdpbnMgd2hlcmUgdGhpcyBvbmUgZW5kc1xuICAgICAgICAgICAgICAgIHN0YXJ0X2FuZ2xlID0gZW5kX2FuZ2xlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHNucCA9IFNuYXAoc3ZnKSxcbiAgICAgICAgICAgIGNvbG9yZWRDaXJjbGUgPSBzbnAuY2lyY2xlKGN4LCBjeSwgKGJhc2UvMikrMC4xKSxcbiAgICAgICAgICAgIGNpcmNsZU92ZXJsYXkgPSBTbmFwKHN2ZykuY2lyY2xlKGN4LCBjeSwgKGJhc2UgLyAyKS01KTtcblxuICAgICAgICBjb2xvcmVkQ2lyY2xlLmF0dHIoe1xuICAgICAgICAgICAgJ2NsYXNzJzogJ3NlbGVjdGVkLWNvbG9yJ1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnNldENvbG9yKGlucHV0LCBzZXR0aW5ncy5jb2xvciwgc3ZnKTtcblxuICAgICAgICBjaXJjbGVPdmVybGF5LmF0dHIoe1xuICAgICAgICAgICAgJ2NsYXNzJzogJ2ljb24nXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZhciBwZW5jaWwgPSB0aGlzLnN2Z19vYmooJ2cnKSxcbiAgICAgICAgICAgIHBpbm5lciA9IHRoaXMuc3ZnX29iaigncGF0aCcpO1xuICAgICAgICB0aGlzLnNldF9hdHRyKHBlbmNpbCwge1xuICAgICAgICAgICAgJ3RyYW5zZm9ybSc6IFwidHJhbnNsYXRlKFwiK1tjeC03LGN5LTddLmpvaW4oJyAnKStcIilcIlxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zZXRfYXR0cihwaW5uZXIsIHtcbiAgICAgICAgICAgICdkJzogXCJNMy40LDEyLjhMNC4yLDEyTDIsOS44bC0wLjgsMC44djFoMS4ydjEuMkgzLjR6IE04LjIsNC4yQzguMiw0LjEsOC4xLDQsOCw0Yy0wLjEsMC0wLjEsMC0wLjIsMC4xbC01LDVjMCwwLTAuMSwwLjEtMC4xLDAuMmMwLDAuMSwwLjEsMC4yLDAuMiwwLjJjMC4xLDAsMC4xLDAsMC4yLTAuMWw1LTVDOC4yLDQuNCw4LjIsNC4zLDguMiw0LjJ6IE03LjcsMi41bDMuOCwzLjhMMy44LDE0SDB2LTMuOCBMNy43LDIuNXogTTE0LDMuNGMwLDAuMy0wLjEsMC42LTAuMywwLjhsLTEuNSwxLjVMOC4zLDEuOWwxLjUtMS41QzEwLDAuMSwxMC4zLDAsMTAuNiwwYzAuMywwLDAuNiwwLjEsMC44LDAuNGwyLjIsMi4yIEMxMy45LDIuOCwxNCwzLDE0LDMuNHpcIixcbiAgICAgICAgICAgICdjbGFzcyc6IFwicGVuY2lsXCJcbiAgICAgICAgfSk7XG4gICAgICAgIHBlbmNpbC5hcHBlbmRDaGlsZChwaW5uZXIpO1xuICAgICAgICBzdmcuYXBwZW5kQ2hpbGQocGVuY2lsKTtcblxuICAgICAgICByZXR1cm4gW2lucHV0LCBzdmddO1xuICAgIH0sXG5cbiAgICBldmVudEhhbmRsZXIgOiBmdW5jdGlvbigpIHtcblxuICAgICAgICBpZiAodHlwZW9mKHRoaXMuc2V0dGluZ3MuZXZlbnRIYW5kbGVyKSE9PSd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLmV2ZW50SGFuZGxlcigpO1xuICAgICAgICB9XG5cbiAgICB9LFxuXG4gICAgYWN0aW9uIDogZnVuY3Rpb24gKGVsLCBpbnB1dCwgc2V0dGluZ3MpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgICAgIGVsLmNsaWNrKGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIHZhciBwYXRoID0gU25hcChlLnRhcmdldCk7XG5cbiAgICAgICAgICAgIHZhciBjb2xvciA9IHBhdGguYXR0cignZmlsbCcpO1xuICAgICAgICAgICAgcGF0aC5hdHRyKHtcbiAgICAgICAgICAgICAgICBzdHJva2VXaWR0aDogMFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHNlbGYuc2V0Q29sb3IoaW5wdXQsIGNvbG9yKTtcblxuICAgICAgICAgICAgc2VsZi5jbG9zZShpbnB1dCwgc2V0dGluZ3MpO1xuXG4gICAgICAgICAgICAvLyBjYWxsIGV2ZW50IGhhbmRsZXIgZGVmaW5lZCBpbnRvIHNldHRpbmdzLCBpZiBkZWZpbmVkIChzZXR0aW5ncy5ldmVudEhhbmRsZXIpXG4gICAgICAgICAgICBzZWxmLmV2ZW50SGFuZGxlcigpO1xuICAgICAgICB9KTtcbiAgICB9LFxuICAgIGFuaW1hdGUgOiBmdW5jdGlvbiAoZWwsIGN4LCBjeSwgc2V0dGluZ3MsIGxldmVsKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcyxcbiAgICAgICAgICAgIGJhc2Vfc2NhbGUgPSAxLFxuICAgICAgICAgICAgc2NhbGUgPSBiYXNlX3NjYWxlICsgMC4wNTtcblxuICAgICAgICBlbC5ob3ZlcihmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgdmFyIHBhdGggPSBTbmFwKGUudGFyZ2V0KTtcblxuICAgICAgICAgICAgLy8gTW92ZSB0byB0aGUgZnJvbnRcbiAgICAgICAgICAgIHBhdGguYXBwZW5kVG8ocGF0aC5wYXJlbnQoKSk7XG5cbiAgICAgICAgICAgIHBhdGguYXR0cih7XG4gICAgICAgICAgICAgICAgc3Ryb2tlV2lkdGg6IDEvKGxldmVsKyAyKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBwYXRoLnN0b3AoKS5hbmltYXRlKHtcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm06ICdzJyArIHNjYWxlICsgJyAnICsgc2NhbGUgKyAnICcgKyBjeCArICcgJyArIGN5XG4gICAgICAgICAgICB9LCBzZXR0aW5ncy5hbmltYXRpb25fc3BlZWQsIG1pbmFbc2V0dGluZ3MuYW5pbWF0aW9uX3R5cGVdKTtcblxuICAgICAgICB9LCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgdmFyIHBhdGggPSBTbmFwKGUudGFyZ2V0KTtcblxuICAgICAgICAgICAgcGF0aC5hdHRyKHtcbiAgICAgICAgICAgICAgICBzdHJva2VXaWR0aDogMFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBwYXRoLnN0b3AoKS5hbmltYXRlKHtcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm06ICdzJyArIGJhc2Vfc2NhbGUgKyAnICcgKyBiYXNlX3NjYWxlICsgJyAnICsgY3ggKyAnICcgKyBjeVxuICAgICAgICAgICAgfSwgc2V0dGluZ3MuYW5pbWF0aW9uX3NwZWVkLCBtaW5hW3NldHRpbmdzLmFuaW1hdGlvbl90eXBlXSk7XG4gICAgICAgIH0pO1xuXG4gICAgfSxcblxuXG4gICAgYW5udWxhcl9zZWN0b3IgOiBmdW5jdGlvbiAocGF0aCwgb3B0aW9ucykge1xuICAgICAgICB2YXIgb3B0cyA9IG9wdGlvbnNXaXRoRGVmYXVsdHMob3B0aW9ucyk7XG5cbiAgICAgICAgdmFyIHAgPSBbIC8vIHBvaW50c1xuICAgICAgICAgICAgW29wdHMuY3ggKyBvcHRzLnIyKk1hdGguc2luKG9wdHMuc3RhcnRSYWRpYW5zKSxcbiAgICAgICAgICAgICAgICBvcHRzLmN5IC0gb3B0cy5yMipNYXRoLmNvcyhvcHRzLnN0YXJ0UmFkaWFucyldLFxuICAgICAgICAgICAgW29wdHMuY3ggKyBvcHRzLnIyKk1hdGguc2luKG9wdHMuY2xvc2VSYWRpYW5zKSxcbiAgICAgICAgICAgICAgICBvcHRzLmN5IC0gb3B0cy5yMipNYXRoLmNvcyhvcHRzLmNsb3NlUmFkaWFucyldLFxuICAgICAgICAgICAgW29wdHMuY3ggKyBvcHRzLnIxKk1hdGguc2luKG9wdHMuY2xvc2VSYWRpYW5zKSxcbiAgICAgICAgICAgICAgICBvcHRzLmN5IC0gb3B0cy5yMSpNYXRoLmNvcyhvcHRzLmNsb3NlUmFkaWFucyldLFxuICAgICAgICAgICAgW29wdHMuY3ggKyBvcHRzLnIxKk1hdGguc2luKG9wdHMuc3RhcnRSYWRpYW5zKSxcbiAgICAgICAgICAgICAgICBvcHRzLmN5IC0gb3B0cy5yMSpNYXRoLmNvcyhvcHRzLnN0YXJ0UmFkaWFucyldLFxuICAgICAgICBdO1xuXG4gICAgICAgIHZhciBhbmdsZURpZmYgPSBvcHRzLmNsb3NlUmFkaWFucyAtIG9wdHMuc3RhcnRSYWRpYW5zO1xuICAgICAgICB2YXIgbGFyZ2VBcmMgPSAoYW5nbGVEaWZmICUgKE1hdGguUEkqMikpID4gTWF0aC5QSSA/IDEgOiAwO1xuICAgICAgICB2YXIgY21kcyA9IFtdO1xuICAgICAgICBjbWRzLnB1c2goXCJNXCIrcFswXS5qb2luKCkpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTW92ZSB0byBQMFxuICAgICAgICBjbWRzLnB1c2goXCJBXCIrW29wdHMucjIsb3B0cy5yMiwwLGxhcmdlQXJjLDEscFsxXV0uam9pbigpKTsgLy8gQXJjIHRvICBQMVxuICAgICAgICBjbWRzLnB1c2goXCJMXCIrcFsyXS5qb2luKCkpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTGluZSB0byBQMlxuICAgICAgICBjbWRzLnB1c2goXCJBXCIrW29wdHMucjEsb3B0cy5yMSwwLGxhcmdlQXJjLDAscFszXV0uam9pbigpKTsgLy8gQXJjIHRvICBQM1xuICAgICAgICBjbWRzLnB1c2goXCJ6XCIpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2xvc2UgcGF0aCAoTGluZSB0byBQMClcbiAgICAgICAgdGhpcy5zZXRfYXR0cihwYXRoLCB7XG4gICAgICAgICAgICAnc3Ryb2tlJzogJ3doaXRlJyxcbiAgICAgICAgICAgICdzdHJva2Utd2lkdGgnOiAwLFxuICAgICAgICAgICAgJ2QnOiBjbWRzLmpvaW4oJyAnKVxuICAgICAgICB9KTtcblxuXG4gICAgICAgIGZ1bmN0aW9uIG9wdGlvbnNXaXRoRGVmYXVsdHMobyl7XG4gICAgICAgICAgICAvLyBDcmVhdGUgYSBuZXcgb2JqZWN0IHNvIHRoYXQgd2UgZG9uJ3QgbXV0YXRlIHRoZSBvcmlnaW5hbFxuICAgICAgICAgICAgdmFyIG8yID0ge1xuICAgICAgICAgICAgICAgIGN4ICAgICAgICAgICA6IG8uY2VudGVyWCB8fCAwLFxuICAgICAgICAgICAgICAgIGN5ICAgICAgICAgICA6IG8uY2VudGVyWSB8fCAwLFxuICAgICAgICAgICAgICAgIHN0YXJ0UmFkaWFucyA6IChvLnN0YXJ0RGVncmVlcyB8fCAwKSxcbiAgICAgICAgICAgICAgICBjbG9zZVJhZGlhbnMgOiAoby5lbmREZWdyZWVzICAgfHwgMCksXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB2YXIgdCA9IG8udGhpY2tuZXNzIT09dW5kZWZpbmVkID8gby50aGlja25lc3MgOiAxMDA7XG4gICAgICAgICAgICBpZiAoby5pbm5lclJhZGl1cyE9PXVuZGVmaW5lZCkgICAgICBvMi5yMSA9IG8uaW5uZXJSYWRpdXM7XG4gICAgICAgICAgICBlbHNlIGlmIChvLm91dGVyUmFkaXVzIT09dW5kZWZpbmVkKSBvMi5yMSA9IG8ub3V0ZXJSYWRpdXMgLSB0O1xuICAgICAgICAgICAgZWxzZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbzIucjEgPSAyMDAgICAgICAgICAgIC0gdDtcbiAgICAgICAgICAgIGlmIChvLm91dGVyUmFkaXVzIT09dW5kZWZpbmVkKSAgICAgIG8yLnIyID0gby5vdXRlclJhZGl1cztcbiAgICAgICAgICAgIGVsc2UgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8yLnIyID0gbzIucjEgICAgICAgICArIHQ7XG5cbiAgICAgICAgICAgIGlmIChvMi5yMTwwKSBvMi5yMSA9IDA7XG4gICAgICAgICAgICBpZiAobzIucjI8MCkgbzIucjIgPSAwO1xuXG4gICAgICAgICAgICByZXR1cm4gbzI7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgcGFkZGluZyA6IGZ1bmN0aW9uKHNldHRpbmdzKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5kZWZhdWx0Q29sb3JzLmxlbmd0aC0xKSAqIHNldHRpbmdzLnJvd193aWR0aDtcbiAgICB9LFxuICAgIHN2ZyA6IGZ1bmN0aW9uIChpbnB1dCwgc2V0dGluZ3MpIHtcbiAgICAgICAgdmFyIGNvbnRhaW5lciA9ICQodGhpcy5pZGVudGlmaWVyKGlucHV0KSksXG4gICAgICAgICAgICBzdmcgPSAkKCdzdmcnLCBjb250YWluZXIpLFxuICAgICAgICAgICAgd2lkdGggPSBjb250YWluZXIud2lkdGgoKSxcbiAgICAgICAgICAgIGhlaWdodCA9IGNvbnRhaW5lci5oZWlnaHQoKTtcblxuICAgICAgICBpZiAoc3ZnLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHN2ZyA9IHN2Z1swXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBzdmcgPSB0aGlzLnN2Z19vYmooJ3N2ZycpO1xuICAgICAgICAgICAgc3ZnLndpZHRoID0gd2lkdGg7XG4gICAgICAgICAgICBzdmcuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHBhZGRpbmcgPSB0aGlzLnBhZGRpbmcoc2V0dGluZ3MpO1xuXG4gICAgICAgIHZhciB2aWV3X2JveCA9IHBhZGRpbmcgKyAnICcgKyBwYWRkaW5nICsgJyAnICtcbiAgICAgICAgICAgICh3aWR0aCkgKyAnICcgK1xuICAgICAgICAgICAgKGhlaWdodCk7XG5cbiAgICAgICAgdGhpcy5zZXRfYXR0cihzdmcsIHt3aWR0aDogJzEwMCUnLCBoZWlnaHQ6ICcxMDAlJywgdmlld0JveDogdmlld19ib3h9KTtcblxuICAgICAgICByZXR1cm4gc3ZnO1xuICAgIH0sXG5cbiAgICBpZGVudGlmaWVyIDogZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIHJldHVybiAnIycgKyBpbnB1dC5kYXRhKCdjb2xvci1pZCcpO1xuICAgIH0sXG5cbiAgICB0aHJvdHRsZSA6IGZ1bmN0aW9uKGZ1biwgZGVsYXkpIHtcbiAgICAgICAgdmFyIHRpbWVyID0gbnVsbDtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBjb250ZXh0ID0gdGhpcywgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7XG4gICAgICAgICAgICB0aW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGZ1bi5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICAgICAgICAgIH0sIGRlbGF5KTtcbiAgICAgICAgfTtcbiAgICB9LFxuXG4gICAgc3ZnX29iaiA6IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlModGhpcy5OUywgdHlwZSk7XG4gICAgfSxcblxuICAgIHRpY2tzOiBmdW5jdGlvbiAobWluLCBtYXgsIGNvdW50KSB7XG4gICAgICAgIHZhciBzcGFuID0gbWF4IC0gbWluLFxuICAgICAgICAgICAgc3RlcCA9IE1hdGgucG93KDEwLCBNYXRoLmZsb29yKE1hdGgubG9nKHNwYW4gLyBjb3VudCkgLyBNYXRoLkxOMTApKSxcbiAgICAgICAgICAgIGVyciA9IGNvdW50IC8gc3BhbiAqIHN0ZXA7XG5cbiAgICAgICAgLy8gRmlsdGVyIHRpY2tzIHRvIGdldCBjbG9zZXIgdG8gdGhlIGRlc2lyZWQgY291bnQuXG4gICAgICAgIGlmIChlcnIgPD0gLjE1KSBzdGVwICo9IDEwO1xuICAgICAgICBlbHNlIGlmIChlcnIgPD0gLjM1KSBzdGVwICo9IDU7XG4gICAgICAgIGVsc2UgaWYgKGVyciA8PSAuNzUpIHN0ZXAgKj0gMjtcblxuICAgICAgICAvLyBSb3VuZCBzdGFydCBhbmQgc3RvcCB2YWx1ZXMgdG8gc3RlcCBpbnRlcnZhbC5cbiAgICAgICAgdmFyIHRzdGFydCA9IE1hdGguY2VpbChtaW4gLyBzdGVwKSAqIHN0ZXAsXG4gICAgICAgICAgICB0c3RvcCA9IE1hdGguZmxvb3IobWF4IC8gc3RlcCkgKiBzdGVwICsgc3RlcCAqIC41LFxuICAgICAgICAgICAgdGlja3MgPSBbXSxcbiAgICAgICAgICAgIHg7XG5cbiAgICAgICAgLy8gbm93IGdlbmVyYXRlIHRpY2tzXG4gICAgICAgIGZvciAoaT10c3RhcnQ7IGkgPCB0c3RvcDsgaSArPSBzdGVwKSB7XG4gICAgICAgICAgICB0aWNrcy5wdXNoKGkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aWNrcztcbiAgICB9LFxuXG4gICAgc2V0X2F0dHIgOiBmdW5jdGlvbiAobm9kZSwgYXR0cnMpIHtcblxuICAgICAgICBmb3IgKGF0dHIgaW4gYXR0cnMpIHtcbiAgICAgICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKGF0dHIsIGF0dHJzW2F0dHJdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICBmbGlwIDogZnVuY3Rpb24gKG5vZGUsIGgpIHtcbiAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoMCwgJyArIGggKycpIHNjYWxlKDEsIC0xKScpO1xuICAgIH0sXG5cbiAgICBkZWZhdWx0Q29sb3JzOiBbXG4gICAgICAgIC8vIElubmVyIGNpcmNsZSAobm90IHNlbGVjdGFibGUpXG4gICAgICAgIFtcbiAgICAgICAgICAgICdmZjVjNGQnLFxuICAgICAgICAgICAgJ2ZmYjg0ZCcsXG4gICAgICAgICAgICAnZmZmZjRkJyxcbiAgICAgICAgICAgICdiYWZmNGQnLFxuICAgICAgICAgICAgJzYxYjhiMicsXG4gICAgICAgICAgICAnNjE1Y2ZmJyxcbiAgICAgICAgICAgICc5ZTc5ZGYnLFxuICAgICAgICAgICAgJ2JhNWNiMidcbiAgICAgICAgXSxcbiAgICAgICAgLy8gRmlyc3QgUm93IG9mIENvbG9yc1xuICAgICAgICBbXG4gICAgICAgICAgICAnYzgxNzE3JyxcbiAgICAgICAgICAgICdmNDVmMjEnLFxuICAgICAgICAgICAgJ2ZmZDgwMCcsXG4gICAgICAgICAgICAnMDA5NTJhJyxcbiAgICAgICAgICAgICcwMGIxOWEnLFxuICAgICAgICAgICAgJzE3NGFhNycsXG4gICAgICAgICAgICAnNjk1NGM0JyxcbiAgICAgICAgICAgICdiMDNmYWEnXG4gICAgICAgIF0sXG4gICAgICAgIC8vIFNlY29uZCBSb3cgb2YgQ29sb3JzXG4gICAgICAgIFtcbiAgICAgICAgICAgICc5ODI0MjQnLFxuICAgICAgICAgICAgJ2YxMzQzNCcsXG4gICAgICAgICAgICAnZmY5MjY0JyxcbiAgICAgICAgICAgICdiYTQ3MTcnLFxuICAgICAgICAgICAgJ2NkYWUwMCcsXG4gICAgICAgICAgICAnZmZlYjdkJyxcbiAgICAgICAgICAgICcwMGNjMzknLFxuICAgICAgICAgICAgJzAwNmUxZicsXG4gICAgICAgICAgICAnMDA4NTc0JyxcbiAgICAgICAgICAgICcxZGYzZDcnLFxuICAgICAgICAgICAgJzM1NzZlYycsXG4gICAgICAgICAgICAnMjM0MDc1JyxcbiAgICAgICAgICAgICc0YTNiOGMnLFxuICAgICAgICAgICAgJzk5ODFmZicsXG4gICAgICAgICAgICAnZWM1OWU0JyxcbiAgICAgICAgICAgICc4MTJjN2MnXG4gICAgICAgIF0sXG5cbiAgICAgICAgLy8gT3V0ZXIgUm93IG9mIENvbG9yc1xuICAgICAgICBbXG4gICAgICAgICAgICAvLyBSZWRcbiAgICAgICAgICAgICc3YTBlMmQnLFxuICAgICAgICAgICAgJzljMmI0MScsXG4gICAgICAgICAgICAnZDI1YjczJyxcbiAgICAgICAgICAgICdmZTYwODAnLFxuICAgICAgICAgICAgLy8gT3JhbmdlXG4gICAgICAgICAgICAnZmU5NDNlJyxcbiAgICAgICAgICAgICdjZDY2MTInLFxuICAgICAgICAgICAgJzk1NDkwYycsXG4gICAgICAgICAgICAnNmMzMTAxJyxcbiAgICAgICAgICAgIC8vIFllbGxvd1xuICAgICAgICAgICAgJ2ExNzkwMCcsXG4gICAgICAgICAgICAnZDE5ZDAwJyxcbiAgICAgICAgICAgICdmZmMwMDAnLFxuICAgICAgICAgICAgJ2QzYzE2MicsXG4gICAgICAgICAgICAvLyBHcmVlblxuICAgICAgICAgICAgJ2JjZmY3NicsXG4gICAgICAgICAgICAnODhlYzFmJyxcbiAgICAgICAgICAgICcyNzlhNTInLFxuICAgICAgICAgICAgJzMyNjEwMCcsXG4gICAgICAgICAgICAvLyBUZWFsXG4gICAgICAgICAgICAnMTA0ZTQ2JyxcbiAgICAgICAgICAgICc0Yjg3N2YnLFxuICAgICAgICAgICAgJzZmYmJiMScsXG4gICAgICAgICAgICAnYTZlYWUxJyxcbiAgICAgICAgICAgIC8vIEJsdWVcbiAgICAgICAgICAgICczNWFlZWMnLFxuICAgICAgICAgICAgJzI0OTFiMCcsXG4gICAgICAgICAgICAnMGQ2NDdkJyxcbiAgICAgICAgICAgICcwMDQyNTUnLFxuICAgICAgICAgICAgLy8gUHVycGxlXG4gICAgICAgICAgICAnMzMwZTcxJyxcbiAgICAgICAgICAgICc1NDAwYTMnLFxuICAgICAgICAgICAgJzgzMDBmZicsXG4gICAgICAgICAgICAnYjc2YWZmJyxcbiAgICAgICAgICAgIC8vIFBpbmtcbiAgICAgICAgICAgICdlMTJiZWMnLFxuICAgICAgICAgICAgJ2ExMGZhYScsXG4gICAgICAgICAgICAnNzMwYTdhJyxcbiAgICAgICAgICAgICc0YjAwNTAnXG4gICAgICAgIF1cblxuICAgIF1cblxufTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
