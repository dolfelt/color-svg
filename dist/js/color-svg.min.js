var ColorSVG={version:"0.1.0",settings:{current_color:null,size:40,multiplier:8,row_width:20,animation_speed:250,animation_type:"backout"},NS:"http://www.w3.org/2000/svg",init:function(t,i){var a=this;this.scope=t||"input.color-picker";var e=this.scope instanceof jQuery?this.scope:$(this.scope);$.extend(!0,this.settings,i),e.length>0&&e.each(function(){var t=$(this);return t.is(":input")&&t.attr("type","hidden").data("options",{color:t.val()}),a.build(t,i)})},setColor:function(t,i,a){if(!a)var e=$(this.identifier(t)),a=$("svg",e);i&&6==i.length&&(i="#"+i);var n=Snap($(".selected-color",a)[0]);n.attr({opacity:i?1:0,fill:i||"#000000"}),t.is(":input")&&t.val(i)},build:function(t,i){var a=$.extend({},this.settings,i,t.data("options"));if(t.data("settings",a),!t.data("color-id")){var e="color"+Math.round(1e4*Math.random()),n=$('<div id="'+e+'" class="color-svg-picker"/>');t.data("color-id",e),$(t).after(n),n.width(a.size).height(a.size)}var r=this;setTimeout(function(){r.updateDOM(r.picker(t)),r.events(t,a)},1)},events:function(t,i){var a=this;$("svg",this.identifier(t)).hover(function(e){var n=i.size+2*a.padding(i);$(this).width(n).height(n)[0].setAttribute("viewBox",["0 0",n,n].join(" ")),$(this).css({margin:-a.padding(i)}),a.animateHover(t,i)},function(e){a.close(t,i,this)})},close:function(t,i,a){var e=i.size,n=a||$("svg",this.identifier(t)),r=this.padding(i);this.animateHover(t,i,function(){$(n).width(e).height(e)[0].setAttribute("viewBox",[r,r,e,e].join(" ")),$(n).css({margin:0})})},updateDOM:function(t){var i=t[0],a=t[1];return $(this.identifier(i)).html(a)},animateHover:function(t,i,a){for(var e=$(this.identifier(t)),n=$("svg",e),r=i.size+2*this.padding(i),s=r/2,o=r/2,c=$("g[data-id]",n),d=0;d<c.length;d++){var h=c[d],f=parseInt(h.getAttribute("data-id").replace("g",""),10),l=a?1:f+2,u=0==d,v=i.animation_type,p=i.animation_speed*(d+1);if(!f){if(!a){var g=i.size/2;l=(g-5)/g}v="easein",p=1.5*i.animation_speed}Snap(h).stop().animate({transform:"s"+l+" "+l+" "+s+" "+o},p,mina[v],u?a||null:null)}var m=$(".selected-color",n)[0],b=Snap(m);b.stop().animate({transform:"s"+l+" "+l+" "+s+" "+o},p,mina[v])},picker:function(t){var i=t.data("settings"),a=this.svg(t,i),e=$(this.identifier(t)),n=e.outerWidth(),r=this.padding(i),s=this.defaultColors.slice();s.reverse();for(var o=0;o<s.length;o++)for(var c=0,d=1/s[o].length*Math.PI*2,h=s[o],f=s.length-(o+1),l=0;l<h.length;l++){var u=c+d,v=n/2+r,p=n/2+r,g=n/2,m=g-5,b=[f,l].join(""),_=$('path[data-id="s'+b+'"]',a);if(_.length>0)var M=_[0];else var M=this.svg_obj("path");this.annular_sector(M,{centerX:v,centerY:p,startDegrees:c,endDegrees:u,innerRadius:0==f?0:(m+(f-1)*i.row_width)/(f+2),outerRadius:0==f?g:(m+f*i.row_width)/(f+2)}),this.set_attr(M,{fill:"#"+h[l],"data-cx":v,"data-cy":p,"data-id":"s"+b});var w=$("g[data-id=g"+f+"]",a);if(w.length<1){var R=this.svg_obj("g");R.setAttribute("data-id","g"+f),R.appendChild(M),a.appendChild(R)}else w[0].appendChild(M);if(f){var j=Snap(M);this.animate(j,v,p,i,f),this.action(j,t,i)}c=u}var C=Snap(a),k=C.circle(v,p,n/2+.1),y=Snap(a).circle(v,p,n/2-5);k.attr({"class":"selected-color"}),this.setColor(t,i.color,a),y.attr({"class":"icon"});var S=this.svg_obj("g"),z=this.svg_obj("path");return this.set_attr(S,{transform:"translate("+[v-7,p-7].join(" ")+")"}),this.set_attr(z,{d:"M3.4,12.8L4.2,12L2,9.8l-0.8,0.8v1h1.2v1.2H3.4z M8.2,4.2C8.2,4.1,8.1,4,8,4c-0.1,0-0.1,0-0.2,0.1l-5,5c0,0-0.1,0.1-0.1,0.2c0,0.1,0.1,0.2,0.2,0.2c0.1,0,0.1,0,0.2-0.1l5-5C8.2,4.4,8.2,4.3,8.2,4.2z M7.7,2.5l3.8,3.8L3.8,14H0v-3.8 L7.7,2.5z M14,3.4c0,0.3-0.1,0.6-0.3,0.8l-1.5,1.5L8.3,1.9l1.5-1.5C10,0.1,10.3,0,10.6,0c0.3,0,0.6,0.1,0.8,0.4l2.2,2.2 C13.9,2.8,14,3,14,3.4z","class":"pencil"}),S.appendChild(z),a.appendChild(S),[t,a]},action:function(t,i,a){var e=this;t.click(function(t){var n=Snap(t.target),r=n.attr("fill");n.attr({strokeWidth:0}),e.setColor(i,r),e.close(i,a)})},animate:function(t,i,a,e,n){var r=1,s=r+.05;t.hover(function(t){var r=Snap(t.target);r.appendTo(r.parent()),r.attr({strokeWidth:1/(n+2)}),r.stop().animate({transform:"s"+s+" "+s+" "+i+" "+a},e.animation_speed,mina[e.animation_type])},function(t){var n=Snap(t.target);n.attr({strokeWidth:0}),n.stop().animate({transform:"s"+r+" "+r+" "+i+" "+a},e.animation_speed,mina[e.animation_type])})},annular_sector:function(t,i){function a(t){var i={cx:t.centerX||0,cy:t.centerY||0,startRadians:t.startDegrees||0,closeRadians:t.endDegrees||0},a=void 0!==t.thickness?t.thickness:100;return i.r1=void 0!==t.innerRadius?t.innerRadius:void 0!==t.outerRadius?t.outerRadius-a:200-a,i.r2=void 0!==t.outerRadius?t.outerRadius:i.r1+a,i.r1<0&&(i.r1=0),i.r2<0&&(i.r2=0),i}var e=a(i),n=[[e.cx+e.r2*Math.sin(e.startRadians),e.cy-e.r2*Math.cos(e.startRadians)],[e.cx+e.r2*Math.sin(e.closeRadians),e.cy-e.r2*Math.cos(e.closeRadians)],[e.cx+e.r1*Math.sin(e.closeRadians),e.cy-e.r1*Math.cos(e.closeRadians)],[e.cx+e.r1*Math.sin(e.startRadians),e.cy-e.r1*Math.cos(e.startRadians)]],r=e.closeRadians-e.startRadians,s=r%(2*Math.PI)>Math.PI?1:0,o=[];o.push("M"+n[0].join()),o.push("A"+[e.r2,e.r2,0,s,1,n[1]].join()),o.push("L"+n[2].join()),o.push("A"+[e.r1,e.r1,0,s,0,n[3]].join()),o.push("z"),this.set_attr(t,{stroke:"white","stroke-width":0,d:o.join(" ")})},padding:function(t){return(this.defaultColors.length-1)*t.row_width},svg:function(t,i){var a=$(this.identifier(t)),e=$("svg",a),n=a.width(),r=a.height();if(e.length>0)e=e[0];else{var e=this.svg_obj("svg");e.width=n,e.height=r}var s=this.padding(i),o=s+" "+s+" "+n+" "+r;return this.set_attr(e,{width:"100%",height:"100%",viewBox:o}),e},identifier:function(t){return"#"+t.data("color-id")},throttle:function(t,i){var a=null;return function(){var e=this,n=arguments;clearTimeout(a),a=setTimeout(function(){t.apply(e,n)},i)}},svg_obj:function(t){return document.createElementNS(this.NS,t)},ticks:function(t,a,e){var n=a-t,r=Math.pow(10,Math.floor(Math.log(n/e)/Math.LN10)),s=e/n*r;.15>=s?r*=10:.35>=s?r*=5:.75>=s&&(r*=2);var o=Math.ceil(t/r)*r,c=Math.floor(a/r)*r+.5*r,d=[];for(i=o;i<c;i+=r)d.push(i);return d},set_attr:function(t,i){for(attr in i)t.setAttribute(attr,i[attr]);return this},flip:function(t,i){t.setAttribute("transform","translate(0, "+i+") scale(1, -1)")},defaultColors:[["ff5c4d","ffb84d","ffff4d","baff4d","61b8b2","615cff","9e79df","ba5cb2"],["c81717","f45f21","ffd800","00952a","00b19a","174aa7","6954c4","b03faa"],["982424","f13434","ff9264","ba4717","cdae00","ffeb7d","00cc39","006e1f","008574","1df3d7","3576ec","234075","4a3b8c","9981ff","ec59e4","812c7c"],["7a0e2d","9c2b41","d25b73","fe6080","fe943e","cd6612","95490c","6c3101","a17900","d19d00","ffc000","d3c162","bcff76","88ec1f","279a52","326100","104e46","4b877f","6fbbb1","a6eae1","35aeec","2491b0","0d647d","004255","330e71","5400a3","8300ff","b76aff","e12bec","a10faa","730a7a","4b0050"]]};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbG9yLXN2Zy5taW4uanMiXSwibmFtZXMiOlsiQ29sb3JTVkciLCJ2ZXJzaW9uIiwic2V0dGluZ3MiLCJjdXJyZW50X2NvbG9yIiwic2l6ZSIsIm11bHRpcGxpZXIiLCJyb3dfd2lkdGgiLCJhbmltYXRpb25fc3BlZWQiLCJhbmltYXRpb25fdHlwZSIsIk5TIiwiaW5pdCIsInNjb3BlIiwib3B0aW9ucyIsInNlbGYiLCJ0aGlzIiwicGlja2VycyIsImpRdWVyeSIsIiQiLCJleHRlbmQiLCJsZW5ndGgiLCJlYWNoIiwiaW5wdXQiLCJpcyIsImF0dHIiLCJkYXRhIiwiY29sb3IiLCJ2YWwiLCJidWlsZCIsInNldENvbG9yIiwic3ZnIiwiY29udGFpbmVyIiwiaWRlbnRpZmllciIsImNpcmNsZSIsIlNuYXAiLCJvcGFjaXR5IiwiZmlsbCIsIl9zZXR0aW5ncyIsImlkIiwiTWF0aCIsInJvdW5kIiwicmFuZG9tIiwiZGl2IiwiYWZ0ZXIiLCJ3aWR0aCIsImhlaWdodCIsInNldFRpbWVvdXQiLCJ1cGRhdGVET00iLCJwaWNrZXIiLCJldmVudHMiLCJob3ZlciIsImUiLCJkaW1lbiIsInBhZGRpbmciLCJzZXRBdHRyaWJ1dGUiLCJqb2luIiwiY3NzIiwibWFyZ2luIiwiYW5pbWF0ZUhvdmVyIiwiY2xvc2UiLCJlbGVtIiwicGFydHMiLCJncmFwaCIsImh0bWwiLCJjbG9zZV9jYWxsYmFjayIsImJhc2UiLCJjeCIsImN5IiwiZ3JvdXBzIiwiZyIsImdyb3VwIiwicGFyc2VJbnQiLCJnZXRBdHRyaWJ1dGUiLCJyZXBsYWNlIiwic2NhbGUiLCJkb19jYWxsYmFjayIsImFuaW1hdGlvbiIsInNwZWVkIiwiaGFsZiIsInN0b3AiLCJhbmltYXRlIiwidHJhbnNmb3JtIiwibWluYSIsImNpciIsIm91dGVyV2lkdGgiLCJfY29sb3JzIiwiZGVmYXVsdENvbG9ycyIsInNsaWNlIiwicmV2ZXJzZSIsImMiLCJzdGFydF9hbmdsZSIsImFuZ2xlIiwiUEkiLCJsZXZlbCIsImkiLCJlbmRfYW5nbGUiLCJyIiwiaW5uZXJSIiwicGlkIiwiZXhpc3RpbmdfcGF0aCIsInBhdGgiLCJzdmdfb2JqIiwiYW5udWxhcl9zZWN0b3IiLCJjZW50ZXJYIiwiY2VudGVyWSIsInN0YXJ0RGVncmVlcyIsImVuZERlZ3JlZXMiLCJpbm5lclJhZGl1cyIsIm91dGVyUmFkaXVzIiwic2V0X2F0dHIiLCJkYXRhLWN4IiwiZGF0YS1jeSIsImRhdGEtaWQiLCJleGlzdGluZ19ncm91cCIsImFwcGVuZENoaWxkIiwiZWwiLCJhY3Rpb24iLCJzbnAiLCJjb2xvcmVkQ2lyY2xlIiwiY2lyY2xlT3ZlcmxheSIsImNsYXNzIiwicGVuY2lsIiwicGlubmVyIiwiZCIsImNsaWNrIiwidGFyZ2V0Iiwic3Ryb2tlV2lkdGgiLCJiYXNlX3NjYWxlIiwiYXBwZW5kVG8iLCJwYXJlbnQiLCJvcHRpb25zV2l0aERlZmF1bHRzIiwibyIsIm8yIiwic3RhcnRSYWRpYW5zIiwiY2xvc2VSYWRpYW5zIiwidCIsInVuZGVmaW5lZCIsInRoaWNrbmVzcyIsInIxIiwicjIiLCJvcHRzIiwicCIsInNpbiIsImNvcyIsImFuZ2xlRGlmZiIsImxhcmdlQXJjIiwiY21kcyIsInB1c2giLCJzdHJva2UiLCJzdHJva2Utd2lkdGgiLCJ2aWV3X2JveCIsInZpZXdCb3giLCJ0aHJvdHRsZSIsImZ1biIsImRlbGF5IiwidGltZXIiLCJjb250ZXh0IiwiYXJncyIsImFyZ3VtZW50cyIsImNsZWFyVGltZW91dCIsImFwcGx5IiwidHlwZSIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudE5TIiwidGlja3MiLCJtaW4iLCJtYXgiLCJjb3VudCIsInNwYW4iLCJzdGVwIiwicG93IiwiZmxvb3IiLCJsb2ciLCJMTjEwIiwiZXJyIiwidHN0YXJ0IiwiY2VpbCIsInRzdG9wIiwibm9kZSIsImF0dHJzIiwiZmxpcCIsImgiXSwibWFwcGluZ3MiOiJBQUFBLEdBQUlBLFdBQ0FDLFFBQVUsUUFFVkMsVUFDSUMsY0FBZSxLQUNmQyxLQUFNLEdBQ05DLFdBQVks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YXIgQ29sb3JTVkcgPSB7XG4gICAgdmVyc2lvbiA6ICcwLjEuMCcsXG5cbiAgICBzZXR0aW5ncyA6IHtcbiAgICAgICAgY3VycmVudF9jb2xvcjogbnVsbCxcbiAgICAgICAgc2l6ZTogNDAsXG4gICAgICAgIG11bHRpcGxpZXI6IDgsXG4gICAgICAgIHJvd193aWR0aDogMjAsXG4gICAgICAgIGFuaW1hdGlvbl9zcGVlZDogMjUwLFxuICAgICAgICBhbmltYXRpb25fdHlwZTogJ2JhY2tvdXQnIC8vIG9wdGlvbnM6IGJhY2tpbiwgYmFja291dCwgYm91bmNlLCBlYXNlaW4sIGVhc2Vpbm91dCwgZWFzZW91dCwgbGluZWFyXG4gICAgfSxcblxuICAgIE5TIDogJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyxcblxuICAgIGluaXQgOiBmdW5jdGlvbiAoc2NvcGUsIG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLnNjb3BlID0gc2NvcGUgfHwgJ2lucHV0LmNvbG9yLXBpY2tlcic7XG5cbiAgICAgICAgdmFyIHBpY2tlcnMgPSB0aGlzLnNjb3BlIGluc3RhbmNlb2YgalF1ZXJ5ID8gdGhpcy5zY29wZSA6ICQodGhpcy5zY29wZSk7XG5cbiAgICAgICAgJC5leHRlbmQodHJ1ZSwgdGhpcy5zZXR0aW5ncywgb3B0aW9ucyk7XG5cbiAgICAgICAgaWYgKHBpY2tlcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcGlja2Vycy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgaW5wdXQgPSAkKHRoaXMpO1xuICAgICAgICAgICAgICAgIGlmIChpbnB1dC5pcygnOmlucHV0JykpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5wdXQuYXR0cigndHlwZScsJ2hpZGRlbicpXG4gICAgICAgICAgICAgICAgICAgICAgICAgLmRhdGEoJ29wdGlvbnMnLCB7Y29sb3I6IGlucHV0LnZhbCgpfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuYnVpbGQoaW5wdXQsIG9wdGlvbnMpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvL3RoaXMuZXZlbnRzKCk7XG4gICAgfSxcblxuICAgIHNldENvbG9yIDogZnVuY3Rpb24oaW5wdXQsIGNvbG9yLCBzdmcpIHtcbiAgICAgICAgaWYgKCFzdmcpIHtcbiAgICAgICAgICAgIHZhciBjb250YWluZXIgPSAkKHRoaXMuaWRlbnRpZmllcihpbnB1dCkpLFxuICAgICAgICAgICAgICAgIHN2ZyA9ICQoJ3N2ZycsIGNvbnRhaW5lcik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY29sb3IgJiYgY29sb3IubGVuZ3RoID09IDYpIGNvbG9yID0gJyMnICsgY29sb3I7XG5cbiAgICAgICAgdmFyIGNpcmNsZSA9IFNuYXAoJCgnLnNlbGVjdGVkLWNvbG9yJywgc3ZnKVswXSk7XG4gICAgICAgIGNpcmNsZS5hdHRyKHtcbiAgICAgICAgICAgIG9wYWNpdHk6IGNvbG9yID8gMSA6IDAsXG4gICAgICAgICAgICBmaWxsOiBjb2xvciB8fCBcIiMwMDAwMDBcIlxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoaW5wdXQuaXMoJzppbnB1dCcpKSB7XG4gICAgICAgICAgICBpbnB1dC52YWwoY29sb3IpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGJ1aWxkIDogZnVuY3Rpb24oaW5wdXQsIG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIF9zZXR0aW5ncyA9ICQuZXh0ZW5kKHt9LCB0aGlzLnNldHRpbmdzLCBvcHRpb25zLCBpbnB1dC5kYXRhKCdvcHRpb25zJykpO1xuICAgICAgICBpbnB1dC5kYXRhKCdzZXR0aW5ncycsIF9zZXR0aW5ncyk7XG5cbiAgICAgICAgaWYgKCFpbnB1dC5kYXRhKCdjb2xvci1pZCcpKSB7XG4gICAgICAgICAgICB2YXIgaWQgPSBcImNvbG9yXCIgKyBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkqMTAwMDApLFxuICAgICAgICAgICAgICAgIGRpdiA9ICQoJzxkaXYgaWQ9XCInK2lkKydcIiBjbGFzcz1cImNvbG9yLXN2Zy1waWNrZXJcIi8+Jyk7XG4gICAgICAgICAgICBpbnB1dC5kYXRhKCdjb2xvci1pZCcsIGlkKTtcbiAgICAgICAgICAgICQoaW5wdXQpLmFmdGVyKGRpdik7XG4gICAgICAgICAgICBkaXYud2lkdGgoX3NldHRpbmdzLnNpemUpLmhlaWdodChfc2V0dGluZ3Muc2l6ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc2VsZi51cGRhdGVET00oc2VsZi5waWNrZXIoaW5wdXQpKTtcbiAgICAgICAgICAgIHNlbGYuZXZlbnRzKGlucHV0LCBfc2V0dGluZ3MpO1xuICAgICAgICB9LCAxKTtcbiAgICB9LFxuXG4gICAgZXZlbnRzIDogZnVuY3Rpb24gKGlucHV0LCBzZXR0aW5ncykge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgJCgnc3ZnJywgdGhpcy5pZGVudGlmaWVyKGlucHV0KSkuaG92ZXIoZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgdmFyIGRpbWVuID0gc2V0dGluZ3Muc2l6ZSArIHNlbGYucGFkZGluZyhzZXR0aW5ncykqMjtcbiAgICAgICAgICAgICQodGhpcykud2lkdGgoZGltZW4pLmhlaWdodChkaW1lbilbMF0uc2V0QXR0cmlidXRlKCd2aWV3Qm94JywgWycwIDAnLGRpbWVuLGRpbWVuXS5qb2luKCcgJykpO1xuICAgICAgICAgICAgJCh0aGlzKS5jc3Moe21hcmdpbjogLXNlbGYucGFkZGluZyhzZXR0aW5ncyl9KTtcblxuICAgICAgICAgICAgc2VsZi5hbmltYXRlSG92ZXIoaW5wdXQsIHNldHRpbmdzKTtcbiAgICAgICAgfSwgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgc2VsZi5jbG9zZShpbnB1dCwgc2V0dGluZ3MsIHRoaXMpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgY2xvc2U6IGZ1bmN0aW9uIChpbnB1dCwgc2V0dGluZ3MsIHN2Zykge1xuICAgICAgICB2YXIgZGltZW4gPSBzZXR0aW5ncy5zaXplLFxuICAgICAgICAgICAgZWxlbSA9IHN2ZyB8fCAkKCdzdmcnLCB0aGlzLmlkZW50aWZpZXIoaW5wdXQpKSxcbiAgICAgICAgICAgIHBhZGRpbmcgPSB0aGlzLnBhZGRpbmcoc2V0dGluZ3MpO1xuXG4gICAgICAgIHRoaXMuYW5pbWF0ZUhvdmVyKGlucHV0LCBzZXR0aW5ncywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkKGVsZW0pLndpZHRoKGRpbWVuKS5oZWlnaHQoZGltZW4pWzBdLnNldEF0dHJpYnV0ZSgndmlld0JveCcsIFtwYWRkaW5nLHBhZGRpbmcsZGltZW4sZGltZW5dLmpvaW4oJyAnKSk7XG4gICAgICAgICAgICAkKGVsZW0pLmNzcyh7bWFyZ2luOiAwfSk7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICB1cGRhdGVET00gOiBmdW5jdGlvbiAocGFydHMpIHtcbiAgICAgICAgdmFyIGlucHV0ID0gcGFydHNbMF0sXG4gICAgICAgICAgICBncmFwaCA9IHBhcnRzWzFdO1xuXG4gICAgICAgIHJldHVybiAkKHRoaXMuaWRlbnRpZmllcihpbnB1dCkpLmh0bWwoZ3JhcGgpO1xuICAgIH0sXG5cbiAgICBhbmltYXRlSG92ZXIgOiBmdW5jdGlvbihpbnB1dCwgc2V0dGluZ3MsIGNsb3NlX2NhbGxiYWNrKSB7XG4gICAgICAgIHZhciBjb250YWluZXIgPSAkKHRoaXMuaWRlbnRpZmllcihpbnB1dCkpLFxuICAgICAgICAgICAgc3ZnID0gJCgnc3ZnJywgY29udGFpbmVyKSxcbiAgICAgICAgICAgIGJhc2UgPSBzZXR0aW5ncy5zaXplICsgKHRoaXMucGFkZGluZyhzZXR0aW5ncykqMiksXG4gICAgICAgICAgICBjeCA9IGJhc2UvMixcbiAgICAgICAgICAgIGN5ID0gYmFzZS8gMjtcblxuICAgICAgICB2YXIgZ3JvdXBzID0gJCgnZ1tkYXRhLWlkXScsIHN2Zyk7XG5cbiAgICAgICAgZm9yICh2YXIgZyA9IDA7IGcgPCBncm91cHMubGVuZ3RoOyBnKyspIHtcbiAgICAgICAgICAgIHZhciBncm91cCA9IGdyb3Vwc1tnXSxcbiAgICAgICAgICAgICAgICBpZCA9IHBhcnNlSW50KGdyb3VwLmdldEF0dHJpYnV0ZSgnZGF0YS1pZCcpLnJlcGxhY2UoXCJnXCIsXCJcIiksIDEwKSxcbiAgICAgICAgICAgICAgICBzY2FsZSA9IGNsb3NlX2NhbGxiYWNrID8gMSA6IGlkICsgMixcbiAgICAgICAgICAgICAgICBkb19jYWxsYmFjayA9IGcgPT0gMCxcbiAgICAgICAgICAgICAgICBhbmltYXRpb24gPSBzZXR0aW5ncy5hbmltYXRpb25fdHlwZSxcbiAgICAgICAgICAgICAgICBzcGVlZCA9IHNldHRpbmdzLmFuaW1hdGlvbl9zcGVlZCAqIChnKzEpO1xuXG4gICAgICAgICAgICBpZiAoIWlkKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFjbG9zZV9jYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaGFsZiA9IHNldHRpbmdzLnNpemUvMjtcbiAgICAgICAgICAgICAgICAgICAgc2NhbGUgPSAoaGFsZi01KSAvIGhhbGY7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGFuaW1hdGlvbiA9ICdlYXNlaW4nO1xuICAgICAgICAgICAgICAgIHNwZWVkID0gc2V0dGluZ3MuYW5pbWF0aW9uX3NwZWVkICogMS41O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBTbmFwKGdyb3VwKS5zdG9wKCkuYW5pbWF0ZSh7XG4gICAgICAgICAgICAgIHRyYW5zZm9ybTogJ3MnICsgc2NhbGUgKyAnICcgKyBzY2FsZSArICcgJyArIGN4ICsgJyAnICsgY3lcbiAgICAgICAgICAgIH0sIHNwZWVkLCBtaW5hW2FuaW1hdGlvbl0sIGRvX2NhbGxiYWNrID8gY2xvc2VfY2FsbGJhY2sgfHwgbnVsbCA6IG51bGwpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGNpcmNsZSA9ICQoJy5zZWxlY3RlZC1jb2xvcicsIHN2ZylbMF0sXG4gICAgICAgICAgICBjaXIgPSBTbmFwKGNpcmNsZSk7XG4gICAgICAgIGNpci5zdG9wKCkuYW5pbWF0ZSh7XG4gICAgICAgICAgICB0cmFuc2Zvcm06ICdzJyArIHNjYWxlICsgJyAnICsgc2NhbGUgKyAnICcgKyBjeCArICcgJyArIGN5XG4gICAgICAgIH0sIHNwZWVkLCBtaW5hW2FuaW1hdGlvbl0pO1xuICAgIH0sXG5cbiAgICBwaWNrZXI6IGZ1bmN0aW9uKGlucHV0KSB7XG4gICAgICAgIHZhciBzZXR0aW5ncyA9IGlucHV0LmRhdGEoJ3NldHRpbmdzJyksXG4gICAgICAgICAgICBzdmcgPSB0aGlzLnN2ZyhpbnB1dCwgc2V0dGluZ3MpLFxuICAgICAgICAgICAgY29udGFpbmVyID0gJCh0aGlzLmlkZW50aWZpZXIoaW5wdXQpKSxcbiAgICAgICAgICAgIGJhc2UgPSBjb250YWluZXIub3V0ZXJXaWR0aCgpLFxuICAgICAgICAgICAgcGFkZGluZyA9IHRoaXMucGFkZGluZyhzZXR0aW5ncyk7XG5cbiAgICAgICAgdmFyIF9jb2xvcnMgPSB0aGlzLmRlZmF1bHRDb2xvcnMuc2xpY2UoKTtcbiAgICAgICAgX2NvbG9ycy5yZXZlcnNlKCk7XG4gICAgICAgIC8vIEFkZCB0aGUgbGFzdCBncm91cCB0d2ljZSB0aGUgZWZmZWN0XG4gICAgICAgIC8vIFRPRE86IEFsbG93IG11bHRpcGxlIGNvbG9ycyBmb3IgZGlzcGxheTogX2NvbG9ycy5wdXNoKF9jb2xvcnNbX2NvbG9ycy5sZW5ndGgtMV0pO1xuXG4gICAgICAgIGZvciAodmFyIGM9MDsgYyA8IF9jb2xvcnMubGVuZ3RoOyBjKyspIHtcblxuICAgICAgICAgICAgdmFyIHN0YXJ0X2FuZ2xlID0gMCxcbiAgICAgICAgICAgICAgICBhbmdsZSA9ICgxIC8gX2NvbG9yc1tjXS5sZW5ndGgpICogTWF0aC5QSSAqIDIsXG4gICAgICAgICAgICAgICAgZGF0YSA9IF9jb2xvcnNbY10sXG4gICAgICAgICAgICAgICAgbGV2ZWwgPSBfY29sb3JzLmxlbmd0aCAtIChjKzEpO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZW5kX2FuZ2xlID0gc3RhcnRfYW5nbGUgKyBhbmdsZTtcbiAgICAgICAgICAgICAgICB2YXIgY3ggPSAoYmFzZSAvIDIpICsgcGFkZGluZyxcbiAgICAgICAgICAgICAgICAgICAgY3kgPSAoYmFzZSAvIDIpICsgcGFkZGluZyxcbiAgICAgICAgICAgICAgICAgICAgciA9ICAoYmFzZSAvIDIpLFxuICAgICAgICAgICAgICAgICAgICBpbm5lclIgPSByIC0gNSxcbiAgICAgICAgICAgICAgICAgICAgcGlkID0gW2xldmVsLGldLmpvaW4oJycpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nX3BhdGggPSAkKCdwYXRoW2RhdGEtaWQ9XCJzJyArIHBpZCArICdcIl0nLCBzdmcpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nX3BhdGgubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aCA9IGV4aXN0aW5nX3BhdGhbMF07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhdGggPSB0aGlzLnN2Z19vYmooJ3BhdGgnKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLmFubnVsYXJfc2VjdG9yKHBhdGgsIHtcbiAgICAgICAgICAgICAgICAgICAgY2VudGVyWDpjeCwgY2VudGVyWTpjeSxcbiAgICAgICAgICAgICAgICAgICAgc3RhcnREZWdyZWVzOnN0YXJ0X2FuZ2xlLCBlbmREZWdyZWVzOmVuZF9hbmdsZSxcbiAgICAgICAgICAgICAgICAgICAgaW5uZXJSYWRpdXM6IGxldmVsPT0wID8gMCA6ICgoaW5uZXJSICsgKChsZXZlbC0xKSAqIHNldHRpbmdzLnJvd193aWR0aCkpIC8gKGxldmVsKzIpKSxcbiAgICAgICAgICAgICAgICAgICAgb3V0ZXJSYWRpdXM6IGxldmVsPT0wID8gciA6ICgoaW5uZXJSICsgKChsZXZlbCkgKiBzZXR0aW5ncy5yb3dfd2lkdGgpKSAvIChsZXZlbCsyKSlcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldF9hdHRyKHBhdGgsIHtcbiAgICAgICAgICAgICAgICAgICAgZmlsbDogJyMnK2RhdGFbaV0sXG4gICAgICAgICAgICAgICAgICAgIC8vc3Ryb2tlOiBzZXR0aW5ncy5zdHJva2VfY29sb3IsXG4gICAgICAgICAgICAgICAgICAgIC8vJ3N0cm9rZVdpZHRoJzogc2V0dGluZ3Muc3Ryb2tlX3dpZHRoLFxuICAgICAgICAgICAgICAgICAgICAnZGF0YS1jeCcgOiBjeCxcbiAgICAgICAgICAgICAgICAgICAgJ2RhdGEtY3knIDogY3ksXG4gICAgICAgICAgICAgICAgICAgICdkYXRhLWlkJyA6ICdzJyArIHBpZFxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nX2dyb3VwID0gJCgnZ1tkYXRhLWlkPWcnICsgbGV2ZWwgKyAnXScsIHN2Zyk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZXhpc3RpbmdfZ3JvdXAubGVuZ3RoIDwgMSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZyA9IHRoaXMuc3ZnX29iaignZycpO1xuXG4gICAgICAgICAgICAgICAgICAgIGcuc2V0QXR0cmlidXRlKCdkYXRhLWlkJywgJ2cnICsgbGV2ZWwpO1xuICAgICAgICAgICAgICAgICAgICBnLmFwcGVuZENoaWxkKHBhdGgpO1xuICAgICAgICAgICAgICAgICAgICBzdmcuYXBwZW5kQ2hpbGQoZyk7XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGV4aXN0aW5nX2dyb3VwWzBdLmFwcGVuZENoaWxkKHBhdGgpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChsZXZlbCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZWwgPSBTbmFwKHBhdGgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFuaW1hdGUoZWwsIGN4LCBjeSwgc2V0dGluZ3MsIGxldmVsKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3Rpb24oZWwsIGlucHV0LCBzZXR0aW5ncyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gVGhlIG5leHQgd2VkZ2UgYmVnaW5zIHdoZXJlIHRoaXMgb25lIGVuZHNcbiAgICAgICAgICAgICAgICBzdGFydF9hbmdsZSA9IGVuZF9hbmdsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzbnAgPSBTbmFwKHN2ZyksXG4gICAgICAgICAgICBjb2xvcmVkQ2lyY2xlID0gc25wLmNpcmNsZShjeCwgY3ksIChiYXNlLzIpKzAuMSksXG4gICAgICAgICAgICBjaXJjbGVPdmVybGF5ID0gU25hcChzdmcpLmNpcmNsZShjeCwgY3ksIChiYXNlIC8gMiktNSk7XG5cbiAgICAgICAgY29sb3JlZENpcmNsZS5hdHRyKHtcbiAgICAgICAgICAgICdjbGFzcyc6ICdzZWxlY3RlZC1jb2xvcidcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5zZXRDb2xvcihpbnB1dCwgc2V0dGluZ3MuY29sb3IsIHN2Zyk7XG5cbiAgICAgICAgY2lyY2xlT3ZlcmxheS5hdHRyKHtcbiAgICAgICAgICAgICdjbGFzcyc6ICdpY29uJ1xuICAgICAgICB9KTtcblxuICAgICAgICB2YXIgcGVuY2lsID0gdGhpcy5zdmdfb2JqKCdnJyksXG4gICAgICAgICAgICBwaW5uZXIgPSB0aGlzLnN2Z19vYmooJ3BhdGgnKTtcbiAgICAgICAgdGhpcy5zZXRfYXR0cihwZW5jaWwsIHtcbiAgICAgICAgICAgICd0cmFuc2Zvcm0nOiBcInRyYW5zbGF0ZShcIitbY3gtNyxjeS03XS5qb2luKCcgJykrXCIpXCJcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2V0X2F0dHIocGlubmVyLCB7XG4gICAgICAgICAgICAnZCc6IFwiTTMuNCwxMi44TDQuMiwxMkwyLDkuOGwtMC44LDAuOHYxaDEuMnYxLjJIMy40eiBNOC4yLDQuMkM4LjIsNC4xLDguMSw0LDgsNGMtMC4xLDAtMC4xLDAtMC4yLDAuMWwtNSw1YzAsMC0wLjEsMC4xLTAuMSwwLjJjMCwwLjEsMC4xLDAuMiwwLjIsMC4yYzAuMSwwLDAuMSwwLDAuMi0wLjFsNS01QzguMiw0LjQsOC4yLDQuMyw4LjIsNC4yeiBNNy43LDIuNWwzLjgsMy44TDMuOCwxNEgwdi0zLjggTDcuNywyLjV6IE0xNCwzLjRjMCwwLjMtMC4xLDAuNi0wLjMsMC44bC0xLjUsMS41TDguMywxLjlsMS41LTEuNUMxMCwwLjEsMTAuMywwLDEwLjYsMGMwLjMsMCwwLjYsMC4xLDAuOCwwLjRsMi4yLDIuMiBDMTMuOSwyLjgsMTQsMywxNCwzLjR6XCIsXG4gICAgICAgICAgICAnY2xhc3MnOiBcInBlbmNpbFwiXG4gICAgICAgIH0pO1xuICAgICAgICBwZW5jaWwuYXBwZW5kQ2hpbGQocGlubmVyKTtcbiAgICAgICAgc3ZnLmFwcGVuZENoaWxkKHBlbmNpbCk7XG5cbiAgICAgICAgcmV0dXJuIFtpbnB1dCwgc3ZnXTtcbiAgICB9LFxuXG4gICAgYWN0aW9uIDogZnVuY3Rpb24gKGVsLCBpbnB1dCwgc2V0dGluZ3MpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgICAgIGVsLmNsaWNrKGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIHZhciBwYXRoID0gU25hcChlLnRhcmdldCk7XG5cbiAgICAgICAgICAgIHZhciBjb2xvciA9IHBhdGguYXR0cignZmlsbCcpO1xuICAgICAgICAgICAgcGF0aC5hdHRyKHtcbiAgICAgICAgICAgICAgICBzdHJva2VXaWR0aDogMFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHNlbGYuc2V0Q29sb3IoaW5wdXQsIGNvbG9yKTtcblxuICAgICAgICAgICAgc2VsZi5jbG9zZShpbnB1dCwgc2V0dGluZ3MpO1xuICAgICAgICB9KTtcbiAgICB9LFxuICAgIGFuaW1hdGUgOiBmdW5jdGlvbiAoZWwsIGN4LCBjeSwgc2V0dGluZ3MsIGxldmVsKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcyxcbiAgICAgICAgICAgIGJhc2Vfc2NhbGUgPSAxLFxuICAgICAgICAgICAgc2NhbGUgPSBiYXNlX3NjYWxlICsgMC4wNTtcblxuICAgICAgICBlbC5ob3ZlcihmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgdmFyIHBhdGggPSBTbmFwKGUudGFyZ2V0KTtcblxuICAgICAgICAgICAgLy8gTW92ZSB0byB0aGUgZnJvbnRcbiAgICAgICAgICAgIHBhdGguYXBwZW5kVG8ocGF0aC5wYXJlbnQoKSk7XG5cbiAgICAgICAgICAgIHBhdGguYXR0cih7XG4gICAgICAgICAgICAgICAgc3Ryb2tlV2lkdGg6IDEvKGxldmVsKyAyKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBwYXRoLnN0b3AoKS5hbmltYXRlKHtcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm06ICdzJyArIHNjYWxlICsgJyAnICsgc2NhbGUgKyAnICcgKyBjeCArICcgJyArIGN5XG4gICAgICAgICAgICB9LCBzZXR0aW5ncy5hbmltYXRpb25fc3BlZWQsIG1pbmFbc2V0dGluZ3MuYW5pbWF0aW9uX3R5cGVdKTtcblxuICAgICAgICB9LCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgdmFyIHBhdGggPSBTbmFwKGUudGFyZ2V0KTtcblxuICAgICAgICAgICAgcGF0aC5hdHRyKHtcbiAgICAgICAgICAgICAgICBzdHJva2VXaWR0aDogMFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBwYXRoLnN0b3AoKS5hbmltYXRlKHtcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm06ICdzJyArIGJhc2Vfc2NhbGUgKyAnICcgKyBiYXNlX3NjYWxlICsgJyAnICsgY3ggKyAnICcgKyBjeVxuICAgICAgICAgICAgfSwgc2V0dGluZ3MuYW5pbWF0aW9uX3NwZWVkLCBtaW5hW3NldHRpbmdzLmFuaW1hdGlvbl90eXBlXSk7XG4gICAgICAgIH0pO1xuXG4gICAgfSxcblxuXG4gICAgYW5udWxhcl9zZWN0b3IgOiBmdW5jdGlvbiAocGF0aCwgb3B0aW9ucykge1xuICAgICAgICB2YXIgb3B0cyA9IG9wdGlvbnNXaXRoRGVmYXVsdHMob3B0aW9ucyk7XG5cbiAgICAgICAgdmFyIHAgPSBbIC8vIHBvaW50c1xuICAgICAgICAgICAgW29wdHMuY3ggKyBvcHRzLnIyKk1hdGguc2luKG9wdHMuc3RhcnRSYWRpYW5zKSxcbiAgICAgICAgICAgICAgICBvcHRzLmN5IC0gb3B0cy5yMipNYXRoLmNvcyhvcHRzLnN0YXJ0UmFkaWFucyldLFxuICAgICAgICAgICAgW29wdHMuY3ggKyBvcHRzLnIyKk1hdGguc2luKG9wdHMuY2xvc2VSYWRpYW5zKSxcbiAgICAgICAgICAgICAgICBvcHRzLmN5IC0gb3B0cy5yMipNYXRoLmNvcyhvcHRzLmNsb3NlUmFkaWFucyldLFxuICAgICAgICAgICAgW29wdHMuY3ggKyBvcHRzLnIxKk1hdGguc2luKG9wdHMuY2xvc2VSYWRpYW5zKSxcbiAgICAgICAgICAgICAgICBvcHRzLmN5IC0gb3B0cy5yMSpNYXRoLmNvcyhvcHRzLmNsb3NlUmFkaWFucyldLFxuICAgICAgICAgICAgW29wdHMuY3ggKyBvcHRzLnIxKk1hdGguc2luKG9wdHMuc3RhcnRSYWRpYW5zKSxcbiAgICAgICAgICAgICAgICBvcHRzLmN5IC0gb3B0cy5yMSpNYXRoLmNvcyhvcHRzLnN0YXJ0UmFkaWFucyldLFxuICAgICAgICBdO1xuXG4gICAgICAgIHZhciBhbmdsZURpZmYgPSBvcHRzLmNsb3NlUmFkaWFucyAtIG9wdHMuc3RhcnRSYWRpYW5zO1xuICAgICAgICB2YXIgbGFyZ2VBcmMgPSAoYW5nbGVEaWZmICUgKE1hdGguUEkqMikpID4gTWF0aC5QSSA/IDEgOiAwO1xuICAgICAgICB2YXIgY21kcyA9IFtdO1xuICAgICAgICBjbWRzLnB1c2goXCJNXCIrcFswXS5qb2luKCkpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTW92ZSB0byBQMFxuICAgICAgICBjbWRzLnB1c2goXCJBXCIrW29wdHMucjIsb3B0cy5yMiwwLGxhcmdlQXJjLDEscFsxXV0uam9pbigpKTsgLy8gQXJjIHRvICBQMVxuICAgICAgICBjbWRzLnB1c2goXCJMXCIrcFsyXS5qb2luKCkpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTGluZSB0byBQMlxuICAgICAgICBjbWRzLnB1c2goXCJBXCIrW29wdHMucjEsb3B0cy5yMSwwLGxhcmdlQXJjLDAscFszXV0uam9pbigpKTsgLy8gQXJjIHRvICBQM1xuICAgICAgICBjbWRzLnB1c2goXCJ6XCIpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2xvc2UgcGF0aCAoTGluZSB0byBQMClcbiAgICAgICAgdGhpcy5zZXRfYXR0cihwYXRoLCB7XG4gICAgICAgICAgICAnc3Ryb2tlJzogJ3doaXRlJyxcbiAgICAgICAgICAgICdzdHJva2Utd2lkdGgnOiAwLFxuICAgICAgICAgICAgJ2QnOiBjbWRzLmpvaW4oJyAnKVxuICAgICAgICB9KTtcblxuXG4gICAgICAgIGZ1bmN0aW9uIG9wdGlvbnNXaXRoRGVmYXVsdHMobyl7XG4gICAgICAgICAgICAvLyBDcmVhdGUgYSBuZXcgb2JqZWN0IHNvIHRoYXQgd2UgZG9uJ3QgbXV0YXRlIHRoZSBvcmlnaW5hbFxuICAgICAgICAgICAgdmFyIG8yID0ge1xuICAgICAgICAgICAgICAgIGN4ICAgICAgICAgICA6IG8uY2VudGVyWCB8fCAwLFxuICAgICAgICAgICAgICAgIGN5ICAgICAgICAgICA6IG8uY2VudGVyWSB8fCAwLFxuICAgICAgICAgICAgICAgIHN0YXJ0UmFkaWFucyA6IChvLnN0YXJ0RGVncmVlcyB8fCAwKSxcbiAgICAgICAgICAgICAgICBjbG9zZVJhZGlhbnMgOiAoby5lbmREZWdyZWVzICAgfHwgMCksXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB2YXIgdCA9IG8udGhpY2tuZXNzIT09dW5kZWZpbmVkID8gby50aGlja25lc3MgOiAxMDA7XG4gICAgICAgICAgICBpZiAoby5pbm5lclJhZGl1cyE9PXVuZGVmaW5lZCkgICAgICBvMi5yMSA9IG8uaW5uZXJSYWRpdXM7XG4gICAgICAgICAgICBlbHNlIGlmIChvLm91dGVyUmFkaXVzIT09dW5kZWZpbmVkKSBvMi5yMSA9IG8ub3V0ZXJSYWRpdXMgLSB0O1xuICAgICAgICAgICAgZWxzZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbzIucjEgPSAyMDAgICAgICAgICAgIC0gdDtcbiAgICAgICAgICAgIGlmIChvLm91dGVyUmFkaXVzIT09dW5kZWZpbmVkKSAgICAgIG8yLnIyID0gby5vdXRlclJhZGl1cztcbiAgICAgICAgICAgIGVsc2UgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8yLnIyID0gbzIucjEgICAgICAgICArIHQ7XG5cbiAgICAgICAgICAgIGlmIChvMi5yMTwwKSBvMi5yMSA9IDA7XG4gICAgICAgICAgICBpZiAobzIucjI8MCkgbzIucjIgPSAwO1xuXG4gICAgICAgICAgICByZXR1cm4gbzI7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgcGFkZGluZyA6IGZ1bmN0aW9uKHNldHRpbmdzKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5kZWZhdWx0Q29sb3JzLmxlbmd0aC0xKSAqIHNldHRpbmdzLnJvd193aWR0aDtcbiAgICB9LFxuICAgIHN2ZyA6IGZ1bmN0aW9uIChpbnB1dCwgc2V0dGluZ3MpIHtcbiAgICAgICAgdmFyIGNvbnRhaW5lciA9ICQodGhpcy5pZGVudGlmaWVyKGlucHV0KSksXG4gICAgICAgICAgICBzdmcgPSAkKCdzdmcnLCBjb250YWluZXIpLFxuICAgICAgICAgICAgd2lkdGggPSBjb250YWluZXIud2lkdGgoKSxcbiAgICAgICAgICAgIGhlaWdodCA9IGNvbnRhaW5lci5oZWlnaHQoKTtcblxuICAgICAgICBpZiAoc3ZnLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHN2ZyA9IHN2Z1swXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBzdmcgPSB0aGlzLnN2Z19vYmooJ3N2ZycpO1xuICAgICAgICAgICAgc3ZnLndpZHRoID0gd2lkdGg7XG4gICAgICAgICAgICBzdmcuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHBhZGRpbmcgPSB0aGlzLnBhZGRpbmcoc2V0dGluZ3MpO1xuXG4gICAgICAgIHZhciB2aWV3X2JveCA9IHBhZGRpbmcgKyAnICcgKyBwYWRkaW5nICsgJyAnICtcbiAgICAgICAgICAgICh3aWR0aCkgKyAnICcgK1xuICAgICAgICAgICAgKGhlaWdodCk7XG5cbiAgICAgICAgdGhpcy5zZXRfYXR0cihzdmcsIHt3aWR0aDogJzEwMCUnLCBoZWlnaHQ6ICcxMDAlJywgdmlld0JveDogdmlld19ib3h9KTtcblxuICAgICAgICByZXR1cm4gc3ZnO1xuICAgIH0sXG5cbiAgICBpZGVudGlmaWVyIDogZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIHJldHVybiAnIycgKyBpbnB1dC5kYXRhKCdjb2xvci1pZCcpO1xuICAgIH0sXG5cbiAgICB0aHJvdHRsZSA6IGZ1bmN0aW9uKGZ1biwgZGVsYXkpIHtcbiAgICAgICAgdmFyIHRpbWVyID0gbnVsbDtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBjb250ZXh0ID0gdGhpcywgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7XG4gICAgICAgICAgICB0aW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGZ1bi5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICAgICAgICAgIH0sIGRlbGF5KTtcbiAgICAgICAgfTtcbiAgICB9LFxuXG4gICAgc3ZnX29iaiA6IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlModGhpcy5OUywgdHlwZSk7XG4gICAgfSxcblxuICAgIHRpY2tzOiBmdW5jdGlvbiAobWluLCBtYXgsIGNvdW50KSB7XG4gICAgICAgIHZhciBzcGFuID0gbWF4IC0gbWluLFxuICAgICAgICAgICAgc3RlcCA9IE1hdGgucG93KDEwLCBNYXRoLmZsb29yKE1hdGgubG9nKHNwYW4gLyBjb3VudCkgLyBNYXRoLkxOMTApKSxcbiAgICAgICAgICAgIGVyciA9IGNvdW50IC8gc3BhbiAqIHN0ZXA7XG5cbiAgICAgICAgLy8gRmlsdGVyIHRpY2tzIHRvIGdldCBjbG9zZXIgdG8gdGhlIGRlc2lyZWQgY291bnQuXG4gICAgICAgIGlmIChlcnIgPD0gLjE1KSBzdGVwICo9IDEwO1xuICAgICAgICBlbHNlIGlmIChlcnIgPD0gLjM1KSBzdGVwICo9IDU7XG4gICAgICAgIGVsc2UgaWYgKGVyciA8PSAuNzUpIHN0ZXAgKj0gMjtcblxuICAgICAgICAvLyBSb3VuZCBzdGFydCBhbmQgc3RvcCB2YWx1ZXMgdG8gc3RlcCBpbnRlcnZhbC5cbiAgICAgICAgdmFyIHRzdGFydCA9IE1hdGguY2VpbChtaW4gLyBzdGVwKSAqIHN0ZXAsXG4gICAgICAgICAgICB0c3RvcCA9IE1hdGguZmxvb3IobWF4IC8gc3RlcCkgKiBzdGVwICsgc3RlcCAqIC41LFxuICAgICAgICAgICAgdGlja3MgPSBbXSxcbiAgICAgICAgICAgIHg7XG5cbiAgICAgICAgLy8gbm93IGdlbmVyYXRlIHRpY2tzXG4gICAgICAgIGZvciAoaT10c3RhcnQ7IGkgPCB0c3RvcDsgaSArPSBzdGVwKSB7XG4gICAgICAgICAgICB0aWNrcy5wdXNoKGkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aWNrcztcbiAgICB9LFxuXG4gICAgc2V0X2F0dHIgOiBmdW5jdGlvbiAobm9kZSwgYXR0cnMpIHtcblxuICAgICAgICBmb3IgKGF0dHIgaW4gYXR0cnMpIHtcbiAgICAgICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKGF0dHIsIGF0dHJzW2F0dHJdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICBmbGlwIDogZnVuY3Rpb24gKG5vZGUsIGgpIHtcbiAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoMCwgJyArIGggKycpIHNjYWxlKDEsIC0xKScpO1xuICAgIH0sXG5cbiAgICBkZWZhdWx0Q29sb3JzOiBbXG4gICAgICAgIC8vIElubmVyIGNpcmNsZSAobm90IHNlbGVjdGFibGUpXG4gICAgICAgIFtcbiAgICAgICAgICAgICdmZjVjNGQnLFxuICAgICAgICAgICAgJ2ZmYjg0ZCcsXG4gICAgICAgICAgICAnZmZmZjRkJyxcbiAgICAgICAgICAgICdiYWZmNGQnLFxuICAgICAgICAgICAgJzYxYjhiMicsXG4gICAgICAgICAgICAnNjE1Y2ZmJyxcbiAgICAgICAgICAgICc5ZTc5ZGYnLFxuICAgICAgICAgICAgJ2JhNWNiMidcbiAgICAgICAgXSxcbiAgICAgICAgLy8gRmlyc3QgUm93IG9mIENvbG9yc1xuICAgICAgICBbXG4gICAgICAgICAgICAnYzgxNzE3JyxcbiAgICAgICAgICAgICdmNDVmMjEnLFxuICAgICAgICAgICAgJ2ZmZDgwMCcsXG4gICAgICAgICAgICAnMDA5NTJhJyxcbiAgICAgICAgICAgICcwMGIxOWEnLFxuICAgICAgICAgICAgJzE3NGFhNycsXG4gICAgICAgICAgICAnNjk1NGM0JyxcbiAgICAgICAgICAgICdiMDNmYWEnXG4gICAgICAgIF0sXG4gICAgICAgIC8vIFNlY29uZCBSb3cgb2YgQ29sb3JzXG4gICAgICAgIFtcbiAgICAgICAgICAgICc5ODI0MjQnLFxuICAgICAgICAgICAgJ2YxMzQzNCcsXG4gICAgICAgICAgICAnZmY5MjY0JyxcbiAgICAgICAgICAgICdiYTQ3MTcnLFxuICAgICAgICAgICAgJ2NkYWUwMCcsXG4gICAgICAgICAgICAnZmZlYjdkJyxcbiAgICAgICAgICAgICcwMGNjMzknLFxuICAgICAgICAgICAgJzAwNmUxZicsXG4gICAgICAgICAgICAnMDA4NTc0JyxcbiAgICAgICAgICAgICcxZGYzZDcnLFxuICAgICAgICAgICAgJzM1NzZlYycsXG4gICAgICAgICAgICAnMjM0MDc1JyxcbiAgICAgICAgICAgICc0YTNiOGMnLFxuICAgICAgICAgICAgJzk5ODFmZicsXG4gICAgICAgICAgICAnZWM1OWU0JyxcbiAgICAgICAgICAgICc4MTJjN2MnXG4gICAgICAgIF0sXG5cbiAgICAgICAgLy8gT3V0ZXIgUm93IG9mIENvbG9yc1xuICAgICAgICBbXG4gICAgICAgICAgICAvLyBSZWRcbiAgICAgICAgICAgICc3YTBlMmQnLFxuICAgICAgICAgICAgJzljMmI0MScsXG4gICAgICAgICAgICAnZDI1YjczJyxcbiAgICAgICAgICAgICdmZTYwODAnLFxuICAgICAgICAgICAgLy8gT3JhbmdlXG4gICAgICAgICAgICAnZmU5NDNlJyxcbiAgICAgICAgICAgICdjZDY2MTInLFxuICAgICAgICAgICAgJzk1NDkwYycsXG4gICAgICAgICAgICAnNmMzMTAxJyxcbiAgICAgICAgICAgIC8vIFllbGxvd1xuICAgICAgICAgICAgJ2ExNzkwMCcsXG4gICAgICAgICAgICAnZDE5ZDAwJyxcbiAgICAgICAgICAgICdmZmMwMDAnLFxuICAgICAgICAgICAgJ2QzYzE2MicsXG4gICAgICAgICAgICAvLyBHcmVlblxuICAgICAgICAgICAgJ2JjZmY3NicsXG4gICAgICAgICAgICAnODhlYzFmJyxcbiAgICAgICAgICAgICcyNzlhNTInLFxuICAgICAgICAgICAgJzMyNjEwMCcsXG4gICAgICAgICAgICAvLyBUZWFsXG4gICAgICAgICAgICAnMTA0ZTQ2JyxcbiAgICAgICAgICAgICc0Yjg3N2YnLFxuICAgICAgICAgICAgJzZmYmJiMScsXG4gICAgICAgICAgICAnYTZlYWUxJyxcbiAgICAgICAgICAgIC8vIEJsdWVcbiAgICAgICAgICAgICczNWFlZWMnLFxuICAgICAgICAgICAgJzI0OTFiMCcsXG4gICAgICAgICAgICAnMGQ2NDdkJyxcbiAgICAgICAgICAgICcwMDQyNTUnLFxuICAgICAgICAgICAgLy8gUHVycGxlXG4gICAgICAgICAgICAnMzMwZTcxJyxcbiAgICAgICAgICAgICc1NDAwYTMnLFxuICAgICAgICAgICAgJzgzMDBmZicsXG4gICAgICAgICAgICAnYjc2YWZmJyxcbiAgICAgICAgICAgIC8vIFBpbmtcbiAgICAgICAgICAgICdlMTJiZWMnLFxuICAgICAgICAgICAgJ2ExMGZhYScsXG4gICAgICAgICAgICAnNzMwYTdhJyxcbiAgICAgICAgICAgICc0YjAwNTAnXG4gICAgICAgIF1cblxuICAgIF1cblxufTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==